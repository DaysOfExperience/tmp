# RedisåŸºæœ¬åŸç†

### æ•°æ®ç»“æ„

[Redis å¸¸è§æ•°æ®ç±»å‹å’Œåº”ç”¨åœºæ™¯ | å°æ—coding](https://xiaolincoding.com/redis/data_struct/command.html)

[Redis æ•°æ®ç»“æ„ | å°æ—coding](https://xiaolincoding.com/redis/data_struct/data_struct.html)

<img src="https://cdn.xiaolincoding.com//mysql/other/9fa26a74965efbf0f56b707a03bb9b7f-20230309232518487.png" alt="img" style="zoom:67%;" />

æ•°æ®ç±»å‹(å¯¹è±¡çš„ä¿å­˜å½¢å¼) vs æ•°æ®ç»“æ„(æ•°æ®ç±»å‹çš„å®ç°æ–¹å¼)

Redis3.0 -> æœ€æ–°ç‰ˆ : åŒå‘é“¾è¡¨ -> quicklist    å‹ç¼©åˆ—è¡¨ -> listpack

**å…±æœ‰ 8 ç§æ•°æ®ç»“æ„ï¼šSDSã€åŒå‘é“¾è¡¨ã€å‹ç¼©åˆ—è¡¨ã€å“ˆå¸Œè¡¨ã€è·³è¡¨ã€æ•´æ•°é›†åˆã€quicklistã€listpackã€‚**  å¤–åŠ ä¸€ä¸ªå¯¹è±¡

#### é”®å€¼å¯¹æ•°æ®åº“Redisæ˜¯å¦‚ä½•å®ç°çš„   

Redis æ˜¯ä½¿ç”¨äº†ä¸€ä¸ªã€Œå“ˆå¸Œè¡¨ã€ä¿å­˜æ‰€æœ‰é”®å€¼å¯¹

![img](https://cdn.xiaolincoding.com//mysql/other/f302fce6c92c0682024f47bf7579b44c.png)

redisDB - Redis æ•°æ®åº“  dict å…¶å®å°±æ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨(è‹¥æŸä¸€ä¸ªé”®æ˜¯å“ˆå¸Œè¡¨é”®, åˆ™å’Œè¿™ä¸ªæ˜¯ä¸€æ ·çš„, dictht[1]ç”¨äºrehash)   dicthtå°±æ˜¯å“ˆå¸Œè¡¨çš„ç»“æ„  dictEntry...

void * key å’Œ void * value æŒ‡é’ˆæŒ‡å‘çš„æ˜¯ **Redis å¯¹è±¡**  Redis ä¸­çš„æ¯ä¸ªå¯¹è±¡éƒ½ç”± redisObject ç»“æ„è¡¨ç¤º

Rediså¯¹è±¡çš„ç»“æ„: type encoding void *ptr(æŒ‡å‘åº•å±‚æ•°æ®ç»“æ„çš„æŒ‡é’ˆ)

#### SDS

- C è¯­è¨€ä¼ ç»Ÿå­—ç¬¦ä¸²char*çš„ç¼ºé™·
  - Cè¯­è¨€ä¼ ç»Ÿå­—ç¬¦ä¸²è·å–é•¿åº¦çš„æ—¶é—´å¤æ‚åº¦ä¸ºO(N), ä¹Ÿå°±æ˜¯strlen
  - å› ä¸ºä»¥'\0'æ¥æ ‡è¯†å­—ç¬¦ä¸²çš„ç»“å°¾, æ‰€ä»¥åªèƒ½ä¿å­˜æ–‡æœ¬æ•°æ®ï¼Œä¸èƒ½ä¿å­˜åƒå›¾ç‰‡ã€éŸ³é¢‘**ã€**è§†é¢‘æ–‡åŒ–è¿™æ ·çš„äºŒè¿›åˆ¶æ•°æ®
  - å®¹æ˜“ç¼“å†²åŒºæº¢å‡º(å‚è€ƒ`char *strcat(char *dest, const char* src);`å‡½æ•°) ä¸”CåŸç”Ÿæä¾›çš„å­—ç¬¦ä¸²æ“ä½œå‡½æ•°ä¹Ÿä¸é«˜æ•ˆ
- SDSæ•°æ®ç»“æ„(stringçš„å®ç°)
  - å››ä¸ªæˆå‘˜å˜é‡ ğŸ‘€
  - SDSæ‰©å®¹ ğŸ‘€

#### é“¾è¡¨

> cè¯­è¨€æœ¬èº«æ— é“¾è¡¨, æ‰€ä»¥æ˜¯Redisè‡ªå·±å®ç°çš„

é“¾è¡¨èŠ‚ç‚¹ç»“æ„è®¾è®¡: struct listNode å‰åæŒ‡é’ˆ, void *value
é“¾è¡¨: struct list å¤´å°¾èŠ‚ç‚¹, lené•¿åº¦, ä¸‰ä¸ªå‡½æ•°
åŒç«¯æ— ç¯é“¾è¡¨

ä¼˜ç‚¹

- è·å–å¤´å°¾èŠ‚ç‚¹, å‰åèŠ‚ç‚¹O(1)
- è·å–èŠ‚ç‚¹æ•°é‡O(1)
- listNode é“¾è¡¨èŠ‚ä½¿ç”¨ void* æŒ‡é’ˆä¿å­˜èŠ‚ç‚¹å€¼, å› æ­¤**é“¾è¡¨èŠ‚ç‚¹å¯ä»¥ä¿å­˜å„ç§ä¸åŒç±»å‹çš„å€¼**ï¼›(ä¸‰ä¸ªå‡½æ•°... ğŸ‘€)

ç¼ºç‚¹

#### å‹ç¼©åˆ—è¡¨

å‹ç¼©åˆ—è¡¨æ˜¯ Redis ä¸ºäº†èŠ‚çº¦å†…å­˜è€Œå¼€å‘çš„ï¼Œå®ƒæ˜¯**ç”±è¿ç»­å†…å­˜å—ç»„æˆçš„é¡ºåºå‹æ•°æ®ç»“æ„**ï¼Œæœ‰ç‚¹ç±»ä¼¼äºæ•°ç»„ã€‚

è¡¨å¤´ä¸‰ä¸ªå­—æ®µ:

1. zlbytes å†…å­˜å­—èŠ‚æ•°
2. zltail å°¾éƒ¨èŠ‚ç‚¹åç§»é‡
3. zllen èŠ‚ç‚¹æ•°é‡
4. zlend å‹ç¼©åˆ—è¡¨ç»“æŸçš„æ ‡è®°

é™¤äº†é¦–å°¾å…ƒç´ , å…¶ä½™çš„æ˜¯O(N), ä¹Ÿå› æ­¤å‹ç¼©åˆ—è¡¨ä¸é€‚åˆä¿å­˜è¿‡å¤šçš„å…ƒç´ 

å‹ç¼©åˆ—è¡¨çš„èŠ‚ç‚¹çš„ç»“æ„:

1. prevlen å‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦, ç›®çš„æ˜¯ä¸ºäº†å®ç°ä»åå‘å‰éå†(é•¿åº¦ä¸å®š)
2. encoding é€šè¿‡ç¼–ç çš„ä¸åŒ, æ¥æ ‡ç¤ºå½“å‰èŠ‚ç‚¹å®é™…æ•°æ®çš„ã€Œç±»å‹å’Œé•¿åº¦ã€(å­—ç¬¦ä¸²æˆ–æ•´æ•°) (é•¿åº¦ä¸å®š)
3. data å½“å‰èŠ‚ç‚¹çš„å®é™…æ•°æ®

å…³é”®åœ¨äº, prevlen å’Œ encodingçš„å†…å®¹ä»¥åŠé•¿åº¦ éƒ½å’Œæ•°æ®ç±»å‹å’Œæ•°æ®å¤§å°æœ‰å…³

- prevlen 1æˆ–5å­—èŠ‚ä¿å­˜é•¿åº¦, å–å†³äºå‰ä¸€ä¸ªèŠ‚ç‚¹çš„é•¿åº¦(åˆ†ç•Œçº¿254å­—èŠ‚)
- encodingé•¿åº¦å’Œå†…å®¹å–å†³äºæ•°æ®çš„ç±»å‹å’Œé•¿åº¦..

è¿é”æ›´æ–°:

å‹ç¼©åˆ—è¡¨æ–°å¢æŸä¸ªå…ƒç´ æˆ–ä¿®æ”¹æŸä¸ªå…ƒç´ æ—¶ï¼Œå¦‚æœç©ºé—´ä¸ä¸å¤Ÿï¼Œå‹ç¼©åˆ—è¡¨å ç”¨çš„å†…å­˜ç©ºé—´å°±éœ€è¦é‡æ–°åˆ†é…ã€‚
**è€Œå½“æ–°æ’å…¥çš„å…ƒç´ è¾ƒå¤§æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´åç»­å…ƒç´ çš„ prevlen å ç”¨ç©ºé—´éƒ½å‘ç”Ÿå˜åŒ–ï¼Œä»è€Œå¼•èµ·ã€Œè¿é”æ›´æ–°ã€é—®é¢˜ï¼Œå¯¼è‡´æ¯ä¸ªå…ƒç´ çš„ç©ºé—´éƒ½è¦é‡æ–°åˆ†é…**ï¼Œé€ æˆè®¿é—®å‹ç¼©åˆ—è¡¨æ€§èƒ½çš„ä¸‹é™ã€‚

ç¤ºä¾‹..

å‹ç¼©åˆ—è¡¨çš„ç¼ºé™· : è¿é”æ›´æ–°ä¸€æ—¦å‘ç”Ÿï¼Œå°±ä¼šå¯¼è‡´å‹ç¼©åˆ—è¡¨å ç”¨çš„å†…å­˜ç©ºé—´è¦**å¤šæ¬¡é‡æ–°åˆ†é…**

å› æ­¤ï¼Œ**å‹ç¼©åˆ—è¡¨åªä¼šç”¨äºä¿å­˜çš„èŠ‚ç‚¹æ•°é‡ä¸å¤šçš„åœºæ™¯**, åªè¦èŠ‚ç‚¹æ•°é‡è¶³å¤Ÿå°ï¼Œå³ä½¿å‘ç”Ÿè¿é”æ›´æ–°ï¼Œä¹Ÿæ˜¯èƒ½æ¥å—çš„ã€‚

#### å“ˆå¸Œè¡¨

> è¢«åŒ…å«

å“ˆå¸Œè¡¨ç»“æ„è®¾è®¡  å“ˆå¸Œè¡¨èŠ‚ç‚¹ç»“æ„ valueæ˜¯ä¸€ä¸ªè”åˆä½“èŠ‚çœå†…å­˜ç©ºé—´   é“¾å¼å“ˆå¸Œè§£å†³å“ˆå¸Œå†²çª   rehash  æ¸è¿›å¼rehash  rehashè§¦å‘æ¡ä»¶

#### æ•´æ•°é›†åˆ

- ç»“æ„å®šä¹‰ç®€å•  contents æ•°ç»„çš„çœŸæ­£ç±»å‹å–å†³äº intset ç»“æ„ä½“é‡Œçš„ encoding å±æ€§çš„å€¼ã€‚(ä¸ºäº†èŠ‚çœå†…å­˜èµ„æº)

- æ•´æ•°é›†åˆçš„å‡çº§æ“ä½œ åœ¨åŸæœ¬çš„æ•°ç»„ä¸Šæ‰©å±•ç©ºé—´


#### è·³è¡¨

> Zset å‹ç¼©åˆ—è¡¨+è·³è¡¨
>
> Zset å¯¹è±¡åœ¨ä½¿ç”¨è·³è¡¨ä½œä¸ºæ•°æ®ç»“æ„çš„æ—¶å€™ï¼Œæ˜¯ä½¿ç”¨ç”±ã€Œå“ˆå¸Œè¡¨+è·³è¡¨ã€ç»„æˆçš„ struct zset, ä¸ºä»€ä¹ˆè°ˆZsetçš„æ•°æ®ç»“æ„æ—¶åªè°ˆè·³è¡¨ä¸è¯´å“ˆå¸Œè¡¨å‘¢? å› ä¸ºå“ˆå¸Œè¡¨åªæ˜¯ç”¨äºä»¥å¸¸æ•°å¤æ‚åº¦è·å–å…ƒç´ æƒé‡ï¼Œå¤§éƒ¨åˆ†æ“ä½œéƒ½æ˜¯ä¾é è·³è¡¨å®ç°çš„ã€‚
>
> ...
>
> struct zset èƒ½æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚ ZRANGEBYSCORE æ“ä½œï¼‰: è·³è¡¨ å¸¸æ•°å¤æ‚åº¦è·å–å…ƒç´ æƒé‡ï¼ˆå¦‚ ZSCORE æ“ä½œï¼‰: å“ˆå¸Œè¡¨

**è·³è¡¨ç»“æ„è®¾è®¡**

å¤šå±‚ æœ‰åº é“¾è¡¨ æŸ¥æ‰¾è¿‡ç¨‹å°±æ˜¯åœ¨å¤šä¸ªå±‚çº§ä¸Šè·³æ¥è·³å», æœ€åå®šä½åˆ°å…ƒç´ 

```c
typedef struct zskiplistNode {
    //Zset å¯¹è±¡çš„å…ƒç´ å€¼
    sds ele;
    //å…ƒç´ æƒé‡å€¼
    double score;
    //åå‘æŒ‡é’ˆ, æŒ‡å‘å‰ä¸€ä¸ªèŠ‚ç‚¹(å·¦)
    struct zskiplistNode *backward;
  
    //èŠ‚ç‚¹çš„levelæ•°ç»„ï¼Œä¿å­˜æ¯å±‚ä¸Šçš„å‰(å‘å‰, ä¸æ˜¯å‰ä¸€ä¸ª, è€Œæ˜¯åä¸€ä¸ª)å‘æŒ‡é’ˆ(å³)å’Œè·¨åº¦
    struct zskiplistLevel {
        struct zskiplistNode *forward;
        unsigned long span;
    } level[];
} zskiplistNode;
```

é‡ç‚¹åœ¨äºlevel, zskiplistLevelç»“æ„ä½“æ•°ç»„, level æ•°ç»„ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ä»£è¡¨è·³è¡¨ä¸­æŸä¸€ä¸ªèŠ‚ç‚¹çš„æŸä¸€å±‚, level[0]ä¸ºç¬¬ä¸€å±‚, level[1]ä¸ºç¬¬äºŒå±‚, ä»£è¡¨æŸèŠ‚ç‚¹çš„æŸä¸€å±‚çš„ç»“æ„ä½“ä¸­, å­˜å‚¨ç€æŒ‡å‘ä¸‹ä¸€ä¸ªè·³è¡¨èŠ‚ç‚¹çš„æŒ‡é’ˆ å’Œ è·¨åº¦(è¯¥èŠ‚ç‚¹å’Œä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„"è·ç¦»")

è·³è¡¨æ˜¯æœ‰åºå­˜å‚¨, æŒ‰åºæ’åˆ—, **è·¨åº¦å®é™…ä¸Šæ˜¯ä¸ºäº†è®¡ç®—è¿™ä¸ªèŠ‚ç‚¹åœ¨è·³è¡¨ä¸­çš„æ’ä½(ä½ç½®)** ...

```
typedef struct zskiplist {
    struct zskiplistNode *header, *tail;
    unsigned long length;
    int level;
} zskiplist;
```

å¤´å°¾èŠ‚ç‚¹, è·³è¡¨é•¿åº¦(å…ƒç´ ä¸ªæ•°), æœ€å¤§å±‚æ•°

![img](https://cdn.xiaolincoding.com/gh/xiaolincoder/redis/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/3%E5%B1%82%E8%B7%B3%E8%A1%A8-%E8%B7%A8%E5%BA%A6.png)

> æ¯ä¸ªå…ƒç´ (å…ƒç´ å€¼+æƒé‡)éƒ½æ˜¯è‹¥å¹²å±‚çš„, æ¯ä¸€å±‚ æ˜¯å‰åç›¸è¿çš„, ä¹Ÿæ˜¯ä¸Šä¸‹ç›¸è¿çš„
>
> å› ä¸ºè·³è¡¨æ˜¯æœ‰åºçš„, æ•…è¶Šå‘å³, æƒé‡è¶Šå¤§, è‹¥æƒé‡ç›¸åŒ, åˆ™è¶Šå‘å³, å…ƒç´ å€¼çš„å­—å…¸åºè¶Šå¤§(sdså­—ç¬¦ä¸²)

**è·³è¡¨èŠ‚ç‚¹æŸ¥è¯¢è¿‡ç¨‹**

æŸ¥æ‰¾ä¸€ä¸ªè·³è¡¨èŠ‚ç‚¹çš„è¿‡ç¨‹æ—¶ï¼Œè·³è¡¨ä¼šä»**å¤´èŠ‚ç‚¹çš„æœ€é«˜å±‚å¼€å§‹ï¼Œé€ä¸€éå†æ¯ä¸€å±‚**ã€‚åœ¨éå†æŸä¸€å±‚çš„è·³è¡¨èŠ‚ç‚¹æ—¶ï¼Œä¼šç”¨è·³è¡¨èŠ‚ç‚¹ä¸­çš„ SDS ç±»å‹çš„å…ƒç´ å’Œå…ƒç´ çš„æƒé‡æ¥è¿›è¡Œåˆ¤æ–­ï¼Œå…±æœ‰ä¸¤ä¸ªåˆ¤æ–­æ¡ä»¶:

- å¦‚æœå½“å‰èŠ‚ç‚¹çš„æƒé‡ã€Œå°äºã€è¦æŸ¥æ‰¾çš„æƒé‡æ—¶ï¼Œè·³è¡¨å°±ä¼šè®¿é—®è¯¥å±‚ä¸Šçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚
- å¦‚æœå½“å‰èŠ‚ç‚¹çš„æƒé‡ã€Œç­‰äºã€è¦æŸ¥æ‰¾çš„æƒé‡æ—¶ï¼Œå¹¶ä¸”å½“å‰èŠ‚ç‚¹çš„ SDS ç±»å‹æ•°æ®ã€Œå°äºã€è¦æŸ¥æ‰¾çš„æ•°æ®æ—¶ï¼Œè·³è¡¨å°±ä¼šè®¿é—®è¯¥å±‚ä¸Šçš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ã€‚

å¦‚æœä¸Šé¢ä¸¤ä¸ªæ¡ä»¶éƒ½ä¸æ»¡è¶³ï¼Œæˆ–è€…ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸ºç©ºæ—¶ï¼Œè·³è¡¨å°±ä¼šä½¿ç”¨ç›®å‰éå†åˆ°çš„èŠ‚ç‚¹çš„ levelæ•°ç»„é‡Œçš„ä¸‹ä¸€å±‚æŒ‡é’ˆï¼Œç„¶åæ²¿ç€ä¸‹ä¸€å±‚æŒ‡é’ˆç»§ç»­æŸ¥æ‰¾ï¼Œè¿™å°±ç›¸å½“äºè·³åˆ°äº†ä¸‹ä¸€å±‚æ¥ç€æŸ¥æ‰¾ã€‚

> å½“å‰èŠ‚ç‚¹, å®é™…ä¸Šæ˜¯è¿™ä¸€å±‚çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹, è¦åˆ¤æ–­æ˜¯å¦è¦è·³åˆ°è¯¥èŠ‚ç‚¹ä¸Š
>
> æœ€é«˜å±‚å¼€å§‹, çœ‹ä¸‹ä¸€ä¸ªæ˜¯å¦æ»¡è¶³, æ»¡è¶³åˆ™ä¸‹ä¸€ä¸ª, ä¸æ»¡è¶³æˆ–è€…ä¸‹ä¸€ä¸ªä¸ºç©º, åˆ™é™ä½ä¸€å±‚, çœ‹ä¸€ä¸‹ä¸€ä¸ªæ˜¯å¦æ»¡è¶³, æ»¡è¶³åˆ™...

 **è·³è¡¨èŠ‚ç‚¹å±‚æ•°è®¾ç½®**

é‚£æ€æ ·æ‰èƒ½ç»´æŒç›¸é‚»ä¸¤å±‚çš„èŠ‚ç‚¹æ•°é‡çš„æ¯”ä¾‹ä¸º 2 : 1 å‘¢ï¼Ÿ ğŸ‘€

**ä¸ºä»€ä¹ˆç”¨è·³è¡¨è€Œä¸ç”¨å¹³è¡¡æ ‘ï¼Ÿ**

ğŸ‘€

#### quicklist

> åœ¨ Redis 3.0 ä¹‹å‰ï¼ŒList å¯¹è±¡çš„åº•å±‚æ•°æ®ç»“æ„æ˜¯åŒå‘é“¾è¡¨æˆ–è€…å‹ç¼©åˆ—è¡¨ã€‚ç„¶ååœ¨ Redis 3.2 çš„æ—¶å€™ï¼ŒList å¯¹è±¡çš„åº•å±‚æ”¹ç”± quicklist æ•°æ®ç»“æ„å®ç°ã€‚

è¿™é‡Œè®²çš„è¾ƒä¸ºç®€æ´, å¯èƒ½æ˜¯åŸºäºå‹ç¼©åˆ—è¡¨ ğŸ‘€

#### listpack

> æ›¿ä»£äº†æ—§ç‰ˆæœ¬çš„å‹ç¼©åˆ—è¡¨

ç®€çŸ­(éœ€å¯¹æ¯”å‹ç¼©åˆ—è¡¨)

[æ·±å…¥ç†è§£Redisè·³è·ƒè¡¨çš„åŸºæœ¬å®ç°å’Œç‰¹æ€§åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆå›å¿†ä¸€ä¸‹æ™®é€šé“¾è¡¨çš„æ—¶é—´å¤æ‚åº¦ï¼Œå¯ä»¥çœ‹åˆ°é™¤äº† look up æ“ä½œæ˜¯ - æ˜é‡‘](https://juejin.cn/post/6893072817206591496)

### çº¿ç¨‹æ¨¡å‹

å…¶å®å¾ˆå°‘, å°±æ˜¯é‚£ä¸¤ä¸‰ä¸ªé—®é¢˜, ä½†æ˜¯æ˜¯å’Œç½‘ç»œIOç›¸å…³è”çš„, å…ˆè¿™æ ·å§

---

ä¸ºä»€ä¹ˆå•çº¿ç¨‹èƒ½è¿™ä¹ˆå¿«?
éœ€è¦ç†è§£Rediså¤šçº¿ç¨‹æ˜¯è§£å†³ä»€ä¹ˆé—®é¢˜
åˆ†æ¸…æ¥šå‘½ä»¤å¤„ç†ä¸IOå¤„ç†ï¼Œè¿›â€”æ­¥ç†è§£Redisæ¶æ„

[03 é«˜æ€§èƒ½IOæ¨¡å‹ï¼šä¸ºä»€ä¹ˆå•çº¿ç¨‹Redisèƒ½é‚£ä¹ˆå¿«ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /Redis æ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜/03  é«˜æ€§èƒ½IOæ¨¡å‹ï¼šä¸ºä»€ä¹ˆå•çº¿ç¨‹Redisèƒ½é‚£ä¹ˆå¿«ï¼Ÿ.md)

> å…¶å®å°±å¼€å§‹çš„ä¸€ç‚¹ç‚¹, ç¬¬å››ç‚¹è®²çš„æ˜¯ç½‘ç»œIO, å¤šè·¯å¤ç”¨, å¥½ä¹…æ²¡å­¦, å¿˜äº†... 2min

- é¦–å…ˆï¼Œæˆ‘è¦å’Œä½ å˜æ¸…ä¸€ä¸ªäº‹å®: Redisçš„å•çº¿ç¨‹ä»…é™äº...

- Redis ä¸ºä»€ä¹ˆç”¨å•çº¿ç¨‹: å¤šçº¿ç¨‹çš„å¼€é”€(è¿™é‡Œè¦è‡ªå·±èƒ½è¯´å‡ºæ¥, 1. ç†è§£. 2. è®²è¿°)

  > **å¤šçº¿ç¨‹ç¼–ç¨‹æ¨¡å¼é¢ä¸´çš„å…±äº«èµ„æºçš„å¹¶å‘è®¿é—®æ§åˆ¶é—®é¢˜**ã€‚
  >
  > å³ä½¿å¢åŠ äº†çº¿ç¨‹ï¼Œå¤§éƒ¨åˆ†çº¿ç¨‹ä¹Ÿåœ¨ç­‰å¾…è·å–è®¿é—®å…±äº«èµ„æºçš„äº’æ–¥é”ï¼Œå¹¶è¡Œå˜ä¸²è¡Œï¼Œç³»ç»Ÿååç‡å¹¶æ²¡æœ‰éšç€çº¿ç¨‹çš„å¢åŠ è€Œå¢åŠ ã€‚
  >
  > è€Œä¸”ï¼Œé‡‡ç”¨å¤šçº¿ç¨‹å¼€å‘ä¸€èˆ¬ä¼šå¼•å…¥åŒæ­¥åŸè¯­æ¥ä¿æŠ¤å…±äº«èµ„æºçš„å¹¶å‘è®¿é—®ï¼Œè¿™ä¹Ÿä¼šé™ä½ç³»ç»Ÿä»£ç çš„æ˜“è°ƒè¯•æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚ä¸ºäº†é¿å…è¿™äº›é—®é¢˜ï¼ŒRedis ç›´æ¥é‡‡ç”¨äº†å•çº¿ç¨‹æ¨¡å¼ã€‚

- å•çº¿ç¨‹Redisä¸ºä»€ä¹ˆé‚£ä¹ˆå¿«?

  > 1. Redis çš„å¤§éƒ¨åˆ†æ“ä½œåœ¨å†…å­˜ä¸Šå®Œæˆ
  > 2. é‡‡ç”¨äº†é«˜æ•ˆçš„æ•°æ®ç»“æ„ï¼Œä¾‹å¦‚å“ˆå¸Œè¡¨å’Œè·³è¡¨
  > 3. å•çº¿ç¨‹æ¨¡å‹å¯ä»¥ **é¿å…äº†å¤šçº¿ç¨‹ä¹‹é—´çš„ç«äº‰**
  > 4. ç½‘ç»œ IOé‡‡ç”¨äº†å¤šè·¯å¤ç”¨æœºåˆ¶

- åŸºæœ¬ IO æ¨¡å‹ä¸é˜»å¡ç‚¹  ä»è¿™é‡Œå¼€å§‹, åˆ°å°ç»“ä¹‹å‰, ä¸€ç›´è®²å¤šè·¯å¤ç”¨?? 

[é¢è¯•å®˜ï¼šä½ ç¡®å®š Redis æ˜¯å•çº¿ç¨‹çš„è¿›ç¨‹å—ï¼Ÿ-æœ‰äº† (zhipin.com)](https://youle.zhipin.com/articles/750c0e1e89e8d548qxB709-6EA~~.html)

> å¾ˆç›¸ä¼¼, ä½†æ˜¯æ¯”ä¸Šé¢é‚£ä¸ªå¥½(Redis6.0å‰åéƒ½è®²æ¸…æ¥šäº†. é‡ç‚¹è¿˜æ˜¯ç†è§£åŠ è‡ªå·±è®²å‡ºæ¥



[Redis 6.0 æ–°ç‰¹æ€§ï¼šå¸¦ä½  100% æŒæ¡å¤šçº¿ç¨‹æ¨¡å‹ - todo(2æœˆåº•æ²¡çœ‹)](https://juejin.cn/post/6989109527886954527)

æœªæ¥å¯ä»¥å†è¿›ä¸€æ­¥å­¦ä¹ çš„(æœ‰æ—¶é—´, æœ‰ç²¾åŠ›, èƒ½åšåˆ°çš„è¯) 6.0çš„å…¶å®ƒç‰¹æ€§

> æŒºä¸é”™çš„, ç»“åˆèµ·æ¥å§, å¤§è‡´çš„é‡ç‚¹éƒ½æ˜¯ä¸€æ ·çš„

> Redis 6.0 ä¹‹å‰ä¸ºä»€ä¹ˆä¸ä½¿ç”¨å¤šçº¿ç¨‹ï¼Ÿ
>
>  Redis 6.0 ä¸ºå•¥è¦å¼•å…¥å¤šçº¿ç¨‹å‘€ï¼Ÿ
>

### ç¼“å­˜è¿‡æœŸåˆ é™¤ä¸ç¼“å­˜å†…å­˜æ·˜æ±°

ez, ä½†æ˜¯ä¸ç¡®å®šç›®å‰è¿™ç‚¹å¤Ÿä¸å¤Ÿ, ç»“åˆé¢˜åº“å§

> è¿‡æœŸæ·˜æ±°ç®—æ³•  çƒ­ç‚¹é—®é¢˜
>
> è¿‡æœŸåˆ é™¤: å› ä¸ºRedisæ”¯æŒç»™é”®å€¼å¯¹è®¾ç½®è¿‡æœŸæ—¶é—´
>
> å†…å­˜æ·˜æ±°: å› ä¸ºRedisæ˜¯å†…å­˜ç¼“å­˜, å¯èƒ½ä¼šæ»¡, æ»¡äº†éœ€è¦æ¸…é™¤å†…å­˜(å¯ä»¥ä¸æ¸…é™¤)

---

[Redis è¿‡æœŸåˆ é™¤ç­–ç•¥å’Œå†…å­˜æ·˜æ±°ç­–ç•¥æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ | å°æ—coding (xiaolincoding.com)](https://xiaolincoding.com/redis/module/strategy.html)

> ç®€å•æ˜“æ‡‚

- Redis å¯¹ key è®¾ç½®è¿‡æœŸæ—¶é—´çš„ä¸€äº›åŸºæœ¬ä½¿ç”¨å’Œè¯´æ˜

- è¿‡æœŸåˆ é™¤ç­–ç•¥æœ‰å“ªäº›? å®šæ—¶ æƒ°æ€§ å®šæœŸ

- Redisçš„è¿‡æœŸåˆ é™¤ç­–ç•¥? æƒ°æ€§+å®šæœŸ(è¯¦ç»†)

  > æƒ°æ€§: Redis åœ¨è®¿é—®æˆ–è€…ä¿®æ”¹ key ä¹‹å‰, æ£€æŸ¥ key æ˜¯å¦è¿‡æœŸ
  >
  > å®šæœŸ: è¯¦ç»†, å…·ä½“çœ‹

- Rediså†…å­˜æ·˜æ±°æœ‰å“ªäº›ç­–ç•¥? (æœ‰å…³LRU & LFU)

- LRUç®—æ³•è¯´æ˜, Redisçš„è¿‘ä¼¼LRU, ä½†æ˜¯LRUæœ‰ç¼“å­˜æ±¡æŸ“çš„é—®é¢˜(LRUæ˜¯æŒ‰æ—¶é—´è€Œä¸æ˜¯é¢‘ç‡, æœ‰äº›æ•°æ®åªè¯»ä¸€æ¬¡, ä½ å´åªæŒ‰æ—¶é—´, æ±¡æŸ“å†…å­˜)

- Rediså¦‚ä½•å®ç°LRU&LFU  LRUå¾ˆç®€å• LFUå°±æ˜¯å…ˆè¡°å‡, å†å¢åŠ (è¿™ä¸ªè¡¨ç¤ºè®¿é—®é¢‘æ¬¡çš„è¿™ä¸ªå­—æ®µ)

  > LFUè§£å†³äº†å¶å°”è¢«è®¿é—®ä¸€æ¬¡ä¹‹åï¼Œæ•°æ®ç•™å­˜åœ¨ç¼“å­˜ä¸­å¾ˆé•¿ä¸€æ®µæ—¶é—´çš„é—®é¢˜. 

### æŒä¹…åŒ–

è‡ªå·±å†™çš„é‚£ä¸ªè´¨é‡è¿˜æ˜¯é«˜, å†ç¨å¾®ç»“åˆä¸€ä¸‹è¿™ä¸¤ä¸ªæ–‡ç« å°±æ— æ•Œäº†

> AOF RDBæ˜¯è€ƒå¯Ÿçš„é‡ç‚¹
>
> æ¸…æ™°é˜è¿°ä»–ä»¬çš„ä¼˜ç¼ºç‚¹

---

[AOF æŒä¹…åŒ–æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ | å°æ—coding (xiaolincoding.com)](https://xiaolincoding.com/redis/storage/aof.html)

- AOFæœºåˆ¶: å°†å†™å‘½ä»¤ä»¥æ–‡æœ¬çš„å½¢å¼è®°å½•åœ¨ç£ç›˜æ–‡ä»¶ä¸­, ä»¥è¾¾åˆ°æŒä¹…åŒ–çš„ç›®çš„

- ç®€å•åˆ†æ, å¼•å‡º AOF æ—¥å¿—å†™å›ç¡¬ç›˜çš„æ—¶æœº è¿™ä¸ªè¯é¢˜

- AOFå†™å›ç¡¬ç›˜çš„è¿‡ç¨‹, ä»¥åŠä¸‰ç§ç­–ç•¥Always, Everysec, No(**ä¸‰ç§ç­–ç•¥å®é™…ä¸Šæ§åˆ¶çš„å°±æ˜¯å°†AOFæ—¥å¿—æ–‡ä»¶çš„å†…æ ¸ç¼“å†²åŒºå†™å…¥ç£ç›˜çš„é¢‘ç‡**, ä¹Ÿå°±æ˜¯fsyncå‡½æ•°çš„è°ƒç”¨é¢‘ç‡)

  > ä¸‰ç§ç­–ç•¥, ä¸€ç§æ•°æ®çš„æŒä¹…åŒ–æœ€å¥½, å®‰å…¨æ€§æœ€é«˜, æ€§èƒ½æœ€å·®, ä¸€ç§æ€§èƒ½æœ€å¥½, æ•°æ®å®‰å…¨æ€§æœ€å·®. Everysecæ˜¯æŠ˜ä¸­
  >
  > æ€§èƒ½å’Œæ•°æ®çš„å¯é æ€§ä¸èƒ½å…¼é¡¾, è¦å¯é å°±è¦ä»¥æ€§èƒ½ä¸ºä»£ä»·æ¥æ¢å–

- AOFé‡å†™æœºåˆ¶(çˆ¶å­è¿›ç¨‹, å†™æ—¶æ‹·è´, AOFé‡å†™ç¼“å†²åŒº)
  (è¿™é‡Œå†™çš„æœ‰ç‚¹å•°å—¦, å…¶å®æˆ‘ä»–å¦ˆæ—©å­¦ä¼šäº†, åªæ˜¯å¿˜äº†, ç†è§£)

[RDB å¿«ç…§æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ | å°æ—coding (xiaolincoding.com)](https://xiaolincoding.com/redis/storage/rdb.html)

> å°‘, å®¹æ˜“ç†è§£

- RDBçš„ä»‹ç» & å†™æ—¶æ‹·è´ (é‡ç‚¹æ˜¯ä¼˜ç¼ºç‚¹)

- æ··åˆæŒä¹…åŒ– `aof-use-rdb-preamble yes`  æ··åˆæŒä¹…åŒ–å·¥ä½œåœ¨ **AOF æ—¥å¿—é‡å†™è¿‡ç¨‹**ã€‚  (è¿™é‡Œå†™çš„ç®€å•æ˜äº†)

  > å½“å¼€å¯äº†æ··åˆæŒä¹…åŒ–æ—¶ï¼Œåœ¨ AOF é‡å†™æ—¥å¿—æ—¶ï¼Œ`fork` å‡ºæ¥çš„é‡å†™å­è¿›ç¨‹ä¼šå…ˆå°†ä¸ä¸»çº¿ç¨‹å…±äº«çš„å†…å­˜æ•°æ®ä»¥ RDB æ–¹å¼å†™å…¥åˆ° AOF æ–‡ä»¶ï¼Œç„¶åä¸»çº¿ç¨‹å¤„ç†çš„æ“ä½œå‘½ä»¤ä¼šè¢«è®°å½•åœ¨é‡å†™ç¼“å†²åŒºé‡Œï¼Œé‡å†™ç¼“å†²åŒºé‡Œçš„å¢é‡å‘½ä»¤ä¼šä»¥ AOF æ–¹å¼å†™å…¥åˆ° AOF æ–‡ä»¶ï¼Œé‡å†™ç¼“å†²åŒºé‡Œçš„å¢é‡å‘½ä»¤ä¼šä»¥ AOF æ–¹å¼å†™å…¥åˆ° AOF æ–‡ä»¶ï¼Œ

> bgsaveå’ŒAOFé‡å†™éƒ½æ˜¯ä»¥forkåˆ›å»ºå­è¿›ç¨‹çš„å½¢å¼è¿›è¡Œçš„, ä½†æ˜¯rdbæœ¬èº«å°±æ˜¯å…¨é‡ä¸”ç²—ç•¥çš„æŒä¹…åŒ–, æ‰€ä»¥bgsaveæœŸé—´çš„å†™å‘½ä»¤é€ æˆçš„çˆ¶å­è¿›ç¨‹æ•°æ®ä¸ä¸€è‡´ä¸ä¼šå¤„ç†. è€ŒAOFå°±æ˜¯ç»†è‡´çš„æŒä¹…åŒ–, å­è¿›ç¨‹é‡å†™æœŸé—´çš„å†™å‘½ä»¤ä¼šå†™å…¥åˆ°é‡å†™ç¼“å†²åŒº, æœ€ç»ˆä¼šåŠ å…¥åˆ°æ–°çš„AOFæ–‡ä»¶ä¸­

---

[RedisæŒä¹…åŒ–RDBå’ŒAOFä¼˜ç¼ºç‚¹æ˜¯ä»€ä¹ˆï¼Œæ€ä¹ˆå®ç°çš„ï¼Ÿæˆ‘åº”è¯¥ç”¨å“ªä¸€ä¸ªï¼Ÿ - æ¶æ„å¸ˆæŠ€æœ¯æ ˆ - SegmentFault æ€å¦](https://segmentfault.com/a/1190000013958342)

åå‘äºæ€»ç»“ä¼˜ç¼ºç‚¹, æœ‰æ—¶é—´å°±çœ‹ä¸€ä¸‹

### äº‹åŠ¡

[31 äº‹åŠ¡æœºåˆ¶ï¼šRedisèƒ½å®ç°ACIDå±æ€§å—ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /Redis æ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜/31  äº‹åŠ¡æœºåˆ¶ï¼šRedisèƒ½å®ç°ACIDå±æ€§å—ï¼Ÿ.md)

todo  è¿˜å¯ä»¥

# Redisé«˜å¯ç”¨



# Redisåº”ç”¨åœºæ™¯

### ç¼“å­˜å¼‚å¸¸é—®é¢˜

ç¼“å­˜å‡»ç©¿ ç¼“å­˜é›ªå´© ç¼“å­˜ç©¿é€çš„è§£å†³æ–¹æ¡ˆ  ç»å¸¸é—®?

---

é›ªå´©: 1. å¤§é‡ç¼“å­˜æ•°æ®åŒæ—¶è¿‡æœŸ 2. Redisæ•…éšœå®•æœº

å‡»ç©¿: çƒ­ç‚¹æ•°æ®è¿‡æœŸ

ç©¿é€: ç¼“å­˜å’Œæ•°æ®åº“éƒ½ä¸å­˜åœ¨è¿™ä¸ªæ•°æ®

> ç¼“å­˜é›ªå´©  1. å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸ    **ç»™è¿™äº›æ•°æ®çš„è¿‡æœŸæ—¶é—´åŠ ä¸Šä¸€ä¸ªéšæœºæ•°** å‡åŒ€è®¾ç½®è¿‡æœŸæ—¶é—´ 2. äº’æ–¥é”(å¦‚æœkeyä¸ä¸€æ ·, ä¹Ÿäº’æ–¥å—? åº”è¯¥æ˜¯çš„)   3. åå°æ›´æ–°ç¼“å­˜ æ²¡çœ‹æ‡‚= =  2.   Redis æ•…éšœå®•æœº     å¯ä»¥,  *1. æœåŠ¡ç†”æ–­æˆ–è¯·æ±‚é™æµæœºåˆ¶* *2. æ„å»º Redis ç¼“å­˜é«˜å¯é é›†ç¾¤*   
> 
>ç¼“å­˜å‡»ç©¿å¦‚ä½•è§£å†³?   äº’æ–¥é”æ–¹æ¡ˆ  2. .... æ²¡æ³•è¯´å•Š    |   singlelight?????
> 
>ç¼“å­˜ç©¿é€å¦‚ä½•è§£å†³?  éæ³•è¯·æ±‚çš„é™åˆ¶  ç¼“å­˜ç©ºå€¼æˆ–è€…é»˜è®¤å€¼   ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å¿«é€Ÿåˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œé¿å…é€šè¿‡æŸ¥è¯¢æ•°æ®åº“æ¥åˆ¤æ–­æ•°æ®æ˜¯å¦å­˜åœ¨ã€‚  |     å›å†™ç‰¹æ®Šå€¼, å¸ƒéš†è¿‡æ»¤å™¨
> 

[ä»€ä¹ˆæ˜¯ç¼“å­˜é›ªå´©ã€å‡»ç©¿ã€ç©¿é€ï¼Ÿ](https://xiaolincoding.com/redis/cluster/cache_problem.html)

- ä¸‰ä¸ªé—®é¢˜ + ä¸‰ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ³•

> ç¼“å­˜é›ªå´©.å¤§é‡æ•°æ®åŒæ—¶è¿‡æœŸ  1. è¿‡æœŸæ—¶é—´éšæœºåŒ– 2. æ„å»ºç¼“å­˜æ—¶åŠ äº’æ–¥é”(???)  3. åå°æ›´æ–°ç¼“å­˜(?????????)
>
> ç¼“å­˜é›ªå´©.Redisæ•…éšœå®•æœº 1. æœåŠ¡ç†”æ–­æˆ–è¯·æ±‚é™æµæœºåˆ¶(!!!)   2. æ„å»º Redis ç¼“å­˜é«˜å¯é é›†ç¾¤
>
> ç¼“å­˜å‡»ç©¿å’Œé›ªå´©å¾ˆåƒ, æ˜¯é›ªå´©çš„ä¸€ä¸ªå­é›†
>
> ç¼“å­˜ç©¿é€  1. éæ³•è¯·æ±‚çš„é™åˆ¶ 2. ç¼“å­˜ç©ºå€¼æˆ–è€…é»˜è®¤å€¼ 3. ä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨

[04 ç¼“å­˜å¤±æ•ˆã€ç©¿é€å’Œé›ªå´©é—®é¢˜æ€ä¹ˆå¤„ç†ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /300åˆ†é’Ÿåƒé€åˆ†å¸ƒå¼ç¼“å­˜-å®Œ/04 ç¼“å­˜å¤±æ•ˆã€ç©¿é€å’Œé›ªå´©é—®é¢˜æ€ä¹ˆå¤„ç†ï¼Ÿ.md)

> è®²çš„æ›´å®¹æ˜“ç†è§£, æ›´ç»“åˆå®é™…, æ›´ç¨‹åºå‘˜åŒ–

- ç¼“å­˜é›ªå´©.å¤§é‡åŒæ—¶è¿‡æœŸ  éšæœºçš„è¿‡æœŸæ—¶é—´

- ç¼“å­˜ç©¿é€ ä¸€è‡´, è§£å†³1. è‹¥ç©¿é€, åˆ™è®¾å®šç‰¹æ®Šå€¼åˆ°cacheä¸­, 2. å¸ƒéš†è¿‡æ»¤å™¨   (æ›´ç»†ä¸€äº›

- è¿™é‡Œåˆè®²äº†ä¸€ä¸ªç¼“å­˜é›ªå´© å¥‡æ€ªæ²¡çœ‹

[14 ç¼“å­˜ç­–ç•¥ï¼šé¢è¯•ä¸­å¦‚ä½•å›ç­”ç¼“å­˜ç©¿é€ã€é›ªå´©ç­‰é—®é¢˜ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /æ¶æ„è®¾è®¡é¢è¯•ç²¾è®²/14  ç¼“å­˜ç­–ç•¥ï¼šé¢è¯•ä¸­å¦‚ä½•å›ç­”ç¼“å­˜ç©¿é€ã€é›ªå´©ç­‰é—®é¢˜ï¼Ÿ.md)

> æ²¡å•¥ä¸åŒçš„, é™¤äº†ç¬¬äºŒä¸ªéƒ½ä¸€æ ·, é‡ç‚¹æ˜¯è‡ªå·±ç†è§£+èƒ½æ¸…æ¥šçš„è®²è¿°å‡ºæ¥

ç¼“å­˜ç©¿é€(ä¸ç”¨çœ‹)  ç¼“å­˜å¹¶å‘(setnx)(çƒ­ç‚¹æ•°æ®)    ç¼“å­˜é›ªå´©(ä¸ç”¨...)

é™„åŠ çš„æ²¡çœ‹, ä¸æ‡‚

[17 å¦‚ä½•åº”å¯¹ Redis ç¼“å­˜ç©¿é€ã€å‡»ç©¿å’Œé›ªå´©ï¼Ÿ](https://learn.lianglianglee.com/ä¸“æ /è¯´é€æ€§èƒ½æµ‹è¯•/17  å¦‚ä½•åº”å¯¹ Redis ç¼“å­˜ç©¿é€ã€å‡»ç©¿å’Œé›ªå´©ï¼Ÿ.md)

> ä¸ç”¨çœ‹, ä¸ç»†ä¸æ¸…é™¤
>
> æœ€åè®²çš„æ‰æ˜¯é›ªå´© å‡»ç©¿ ç©¿é€ ç®€çŸ­æ˜äº†  å…¶ä»–éƒ¨åˆ†è®²äº†Redisçš„å…¶ä»–å‡ ä¸ªç‰¹æ€§, æ²¡çœ‹

---



> [ç¼“å­˜é—®é¢˜ï¼šæ€ä¹ˆè§£å†³ç¼“å­˜ç©¿é€ã€å‡»ç©¿å’Œé›ªå´©é—®é¢˜ï¼Ÿ | JUST DO IT (leeshengis.com)](https://leeshengis.com/archives/698514)
>
> è¿™ä¸ªè´¨é‡æœ€é«˜ (å…¶å®æ ¸å¿ƒå°±æ˜¯å¦‚ä½•è§£å†³è¿™ä¸‰ä¸ªé—®é¢˜å‘—~)
>
> ç‰›é€¼, è¿™ä¸ªæ–‡ç«      ç‰›é€¼, çœŸçš„
>
> >ç¼“å­˜ç©¿é€çš„è§£å†³æ–¹æ¡ˆ
> >
> >ç¼“å­˜å‡»ç©¿çš„è§£å†³æ–¹æ¡ˆ  (**singleflightå†çœ‹ä¸€ä¸‹**)
> >
> >ç¼“å­˜é›ªå´©çš„è§£å†³æ–¹æ¡ˆ
> >
> >**é™æµå†çœ‹ä¸€ä¸‹**
> >
> >**æœ€åçš„äº®ç‚¹æ–¹æ¡ˆæ²¡ç†è§£**
> >
> >é‡ç‚¹æ˜¯è§£å†³æ–¹æ¡ˆ, æ¯”å¦‚é¢è¯•é—®ä½ , Redisé‡Œé¢ç¼“å­˜å¯èƒ½å‡ºç°çš„å¼‚å¸¸æƒ…å†µ, ä»¥åŠå¦‚ä½•è§£å†³?
>
> > å¤§ä½“æ¥è¯´å·®åˆ«ä¸æ˜¯å¾ˆå¤§... é™æµå’Œå¼‚åœ°æœ‰ç‚¹æ–°äº†, å¤šå­¦å­¦ singleflightå†çœ‹çœ‹
>
> > *
> >
> > å¯ä»¥è®¤ä¸ºç¼“å­˜å‡»ç©¿æ˜¯ç¼“å­˜é›ªå´©çš„ä¸€ä¸ªå­é›†
> >
> > è¿™ä¸ªé—®é¢˜ä¹‹æ‰€ä»¥å¸¸è§ï¼Œæ˜¯å› ä¸ºä½ åœ¨ä½¿ç”¨ç¼“å­˜çš„è¿‡ç¨‹ä¸­ä¸€ä¸å°å¿ƒå°±ä¼šé‡åˆ°å®ƒä»¬ã€‚
> >
> > å› æ­¤ï¼Œå¦‚æœè¯·æ±‚çš„æ•°æ®å¹¶ä¸æ˜¯ä»€ä¹ˆçƒ­ç‚¹æ•°æ®ï¼Œé‚£ä¹ˆå‡»ç©¿ä¹Ÿæ²¡æœ‰ä»€ä¹ˆé—®é¢˜ï¼Œå®ƒå°±æ˜¯æ™®é€šçš„ç¼“å­˜æœªå‘½ä¸­è€Œå·²ã€‚
> >
> > ç¼“å­˜ç©¿é€æ˜¯å› ä¸ºæ•°æ®æœ¬èº«ä¸å­˜åœ¨è€Œå¼•èµ·çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å°±è¦æƒ³åŠæ³•åœ¨ç¡®è®¤æ•°æ®ä¸å­˜åœ¨ä¹‹åï¼Œé¿å…ä¸‹ä¸€æ¬¡æŸ¥è¯¢å†æ¬¡è½åˆ°æ•°æ®åº“ä¸Šã€‚è¿™æœ‰ä¸¤ç§è§£å†³æ€è·¯ã€‚
> >
> > ç¼ºç‚¹

### ç¼“å­˜ä¸€è‡´æ€§é—®é¢˜

ä½ çš„é¡¹ç›®ä¸­rediså’Œmysqlçš„ç¼“å­˜ä¸€è‡´æ€§æ˜¯å¦‚ä½•ä¿è¯çš„?

![image-20250301212422593](C:\Users\yangzilong\Desktop\markdown\CS\Redis\Redisæ–°\image-20250301212422593.png)

---

[æ•°æ®åº“å’Œç¼“å­˜å¦‚ä½•ä¿è¯ä¸€è‡´æ€§ï¼Ÿ | å°æ—coding (xiaolincoding.com)](https://xiaolincoding.com/redis/architecture/mysql_redis_consistency.html#æ•°æ®åº“å’Œç¼“å­˜å¦‚ä½•ä¿è¯ä¸€è‡´æ€§)

> ä¸ºä»€ä¹ˆæœ‰ä¸€è‡´æ€§é—®é¢˜? å› ä¸ºæ›´æ–°æ•°æ®çš„æ—¶å€™, è¯¥æ€ä¹ˆæ›´æ–°?
>
> æœ€ç»ˆå°±æ˜¯, å…ˆæ›´æ–°æ•°æ®åº“, å†åˆ é™¤ç¼“å­˜, å¤–åŠ ä¸€ä¸ªç¼“å­˜è¿‡æœŸæ—¶é—´, å…¶ä½™çš„æœ‰æ›´æ–°å¹¶å‘é—®é¢˜æˆ–è€…è¯»å†™å¹¶å‘é—®é¢˜

- å…ˆæ›´æ•°æ®åº“, åæ›´ç¼“å­˜ æˆ–è€…åç€æ¥, åœ¨æ›´æ–°è¯·æ±‚å¹¶å‘æ›´æ–°åŒä¸€ä¸ªæ•°æ®æ—¶éƒ½å¯èƒ½ä¼šå‡ºç°æ•°æ®åº“å’Œç¼“å­˜æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜, ä¹Ÿå°±æ˜¯å¹¶å‘é—®é¢˜

- Cache Asideç­–ç•¥(æ—è·¯ç¼“å­˜ç­–ç•¥, åå­—ä¸é‡è¦), å†™æ•°æ®æ—¶, é‡‡ç”¨æ›´æ–°æ•°æ®åº“è€Œåˆ é™¤ç¼“å­˜çš„æ–¹å¼, è¯»æ­£å¸¸è¯»

- å†™æ•°æ®æ—¶å…ˆåˆ ç¼“å­˜, åæ›´æ–°æ•°æ®åº“, è¯»å†™å¹¶å‘æ—¶è¿˜æ˜¯ä¼šæœ‰æ•°æ®åº“å’Œç¼“å­˜æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜

- å†™æ•°æ®æ—¶å…ˆæ›´æ–°æ•°æ®åº“, ååˆ ç¼“å­˜å¯ä»¥ä¿è¯æ•°æ®ä¸€è‡´æ€§(å¤–åŠ ä¸€ä¸ªè¿‡æœŸæ—¶é—´)

  > è¿™é‡Œåªè¦æ˜¯åˆ ç¼“å­˜çš„ç­–ç•¥, æ›´æ–°è¯·æ±‚å¹¶å‘æ—¶æ˜¯ä¸ä¼šé€ æˆæ•°æ®ä¸ä¸€è‡´çš„, å› ä¸ºè¿™é‡Œæ ¹æœ¬ä¸ä¼šå†™ç¼“å­˜

- éšæ‚£: åˆ é™¤ç¼“å­˜çš„è¿™ä¸ªæ“ä½œå¯èƒ½å¤±è´¥, å¯¼è‡´ç¼“å­˜ä¸­æ•°æ®å¯èƒ½æ˜¯æ—§æ•°æ®, è€Œå› ä¸ºæœ‰è¿‡æœŸæ—¶é—´, æ‰€ä»¥åªä¼šé€ æˆçŸ­æ—¶é—´çš„æ•°æ®ä¸ä¸€è‡´
  æ¶ˆæ¯é˜Ÿåˆ—æ¥è§£å†³?  è·³è¿‡äº†.. ä¸ä¼š



> å¦å¤–, è‹¥ä¸šåŠ¡å¯¹ç¼“å­˜å‘½ä¸­ç‡æœ‰å¾ˆé«˜çš„è¦æ±‚, 



[è®¤è¯† MySQL å’Œ Redis çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜ (lianglianglee.com)](https://learn.lianglianglee.com/æ–‡ç« /è®¤è¯† MySQL å’Œ Redis çš„æ•°æ®ä¸€è‡´æ€§é—®é¢˜.md)

- å¾ˆä¸¥è°¨åœ°å®šä¹‰æ•°æ®çš„ä¸€è‡´æ€§(ç¼“å­˜ä¸æ•°æ®åº“)

[å¤§å‚éƒ½æ˜¯æ€ä¹ˆåš MySQLtoRedis åŒæ­¥çš„? | MRCODE-BOOK (zq99299.github.io)](https://zq99299.github.io/note-book/back-end-storage/03/03.html#ç¼“å­˜ç©¿é€-è¶…å¤§è§„æ¨¡ç³»ç»Ÿçš„ä¸èƒ½æ‰¿å—ä¹‹ç—›)

[34ï½œç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼šé«˜å¹¶å‘æœåŠ¡å¦‚ä½•ä¿è¯ç¼“å­˜ä¸€è‡´æ€§ï¼Ÿ | è½¦æ–Œçš„æŠ€æœ¯åšå®¢](https://chebin.tech/2023/11/09/34ï½œç¼“å­˜ä¸€è‡´æ€§é—®é¢˜ï¼šé«˜å¹¶å‘æœåŠ¡å¦‚ä½•ä¿è¯ç¼“å­˜ä¸€è‡´æ€§ï¼Ÿ/)

ç»·ä¸ä½äº†, æ—¥åæœ‰ç¼˜å†è§

### åˆ†å¸ƒå¼é”

æ€ä¹ˆç”¨rediså®ç°åˆ†å¸ƒå¼é”?(setnx)
redisåˆ†å¸ƒå¼é”å•æœºå®ä¾‹æŒ‚äº†æ€ä¹ˆåŠ?(redlock)
æ€ä¹ˆç”¨rediså®ç°å¯é‡å¤çš„åˆ†å¸ƒå¼é”?(äº†è§£redissonæ˜¯æ€ä¹ˆå®ç°å¯é‡å¤é”çš„)
æœ‰æ—¶å€™é¢è¯•ä¼šè€ƒå¯Ÿä½ å¯¹åˆ†å¸ƒå¼é”æ–¹æ¡ˆçš„äº†è§£ï¼Œé™¤äº†redisï¼Œè¿˜äº†è§£è¿‡å“ªäº›åˆ†å¸ƒå¼é”çš„æ–¹æ¡ˆï¼Œå¯ä»¥æä¸€ä¸‹mysqlå’Œzkå®ç°åˆ†å¸ƒå¼é”çš„æ–¹æ¡ˆã€‚

---

[30 å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /Redis æ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜/30  å¦‚ä½•ä½¿ç”¨Rediså®ç°åˆ†å¸ƒå¼é”ï¼Ÿ.md)

> ç®€å•ä¸”æ¸…æ™°, å¿«ç‚¹çœ‹

- å¯¹æ¯”å•æœºä¸Šçš„é”å’Œåˆ†å¸ƒå¼é”(å…¶å®å¾ˆç®€å•). å®ç°åˆ†å¸ƒå¼é”çš„ä¸¤ä¸ªè¦æ±‚1. é”æ“ä½œçš„åŸå­æ€§ 2. å…±äº«å­˜å‚¨ç³»ç»Ÿçš„å¯é æ€§(é”çš„å¯é æ€§)

  > ä½†æ˜¯ï¼Œå’Œçº¿ç¨‹åœ¨å•æœºä¸Šæ“ä½œé”ä¸åŒçš„æ˜¯ï¼Œåœ¨åˆ†å¸ƒå¼åœºæ™¯ä¸‹ï¼Œ**é”å˜é‡éœ€è¦ç”±ä¸€ä¸ªå…±äº«å­˜å‚¨ç³»ç»Ÿæ¥ç»´æŠ¤**ï¼Œåªæœ‰è¿™æ ·ï¼Œå¤šä¸ªå®¢æˆ·ç«¯æ‰å¯ä»¥é€šè¿‡è®¿é—®å…±äº«å­˜å‚¨ç³»ç»Ÿæ¥è®¿é—®é”å˜é‡ã€‚ç›¸åº”çš„ï¼ŒåŠ é”å’Œé‡Šæ”¾é”çš„æ“ä½œå°±å˜æˆäº†è¯»å–ã€åˆ¤æ–­å’Œè®¾ç½®å…±äº«å­˜å‚¨ç³»ç»Ÿä¸­çš„é”å˜é‡å€¼ã€‚

- åŸºäºå•ä¸ª Redis èŠ‚ç‚¹å®ç°åˆ†å¸ƒå¼é”

  > é—®é¢˜1: è‹¥æŒæœ‰é”çš„å®¢æˆ·ç«¯å¼‚å¸¸ä¸é‡Šæ”¾é”, ä¸€ç›´å ç”¨æ€ä¹ˆåŠ? ç­”: ç»™é”å˜é‡è®¾å®šä¸€ä¸ªè¿‡æœŸæ—¶é—´
  > é—®é¢˜2: è¯¯é‡Šæ”¾(Bå®¢æˆ·ç«¯é‡Šæ”¾äº†AæŒæœ‰çš„é”) å¯ä»¥è®©æ¯ä¸ªå®¢æˆ·ç«¯ç»™é”å˜é‡è®¾ç½®ä¸€ä¸ªå”¯ä¸€å€¼ï¼Œè¿™é‡Œçš„å”¯ä¸€å€¼å°±å¯ä»¥ç”¨æ¥æ ‡è¯†å½“å‰æ“ä½œçš„å®¢æˆ·ç«¯
  >
  > æœ€ç»ˆ: åŠ é”: 
  >
  > ```
  > // åŠ é”, unique_valueä½œä¸ºå®¢æˆ·ç«¯å”¯ä¸€æ€§çš„æ ‡è¯†
  > SET lock_key unique_value NX PX 10000
  > ```
  >
  > é‡Šæ”¾é”: Luaè„šæœ¬
  >
  > ```
  > //é‡Šæ”¾é” æ¯”è¾ƒunique_valueæ˜¯å¦ç›¸ç­‰ï¼Œé¿å…è¯¯é‡Šæ”¾
  > if redis.call("get",KEYS[1]) == ARGV[1] then
  >     return redis.call("del",KEYS[1])
  > else
  >     return 0
  > end
  > ```
  >
  > åœ¨é‡Šæ”¾é”æ“ä½œä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨äº† Lua è„šæœ¬ï¼Œè¿™æ˜¯å› ä¸ºï¼Œé‡Šæ”¾é”æ“ä½œçš„é€»è¾‘ä¹ŸåŒ…å«äº†è¯»å–é”å˜é‡ã€åˆ¤æ–­å€¼ã€åˆ é™¤é”å˜é‡çš„å¤šä¸ªæ“ä½œï¼Œè€Œ Redis åœ¨æ‰§è¡Œ Lua è„šæœ¬æ—¶ï¼Œå¯ä»¥ä»¥åŸå­æ€§çš„æ–¹å¼æ‰§è¡Œï¼Œä»è€Œä¿è¯äº†é”é‡Šæ”¾æ“ä½œçš„åŸå­æ€§ã€‚

-  åŸºäºå¤šä¸ª Redis èŠ‚ç‚¹å®ç°é«˜å¯é çš„åˆ†å¸ƒå¼é”: åˆ†å¸ƒå¼é”ç®—æ³• Redlock  Redlock ç®—æ³•çš„å®ç°éœ€è¦æœ‰ N ä¸ªç‹¬ç«‹çš„ Redis å®ä¾‹ã€‚

  > çœ‹æ–‡æ¡£å§, å¾ˆç®€å•

[06 åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¦‚ä½•å›ç­”é”çš„å®ç°åŸç†ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /æ¶æ„è®¾è®¡é¢è¯•ç²¾è®²/06  åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¦‚ä½•å›ç­”é”çš„å®ç°åŸç†ï¼Ÿ.md)

> æ¯”è¾ƒåé¢è¯•  ä¸ç”¨çœ‹, è¢«åŒ…æ‹¬ä¸”ä¸å¦‚ä¸Šé¢çš„ç»†, çœ‹æ€»ç»“è¶³å¤Ÿäº†

---

- æ˜ç¡®åˆ†å¸ƒå¼é”ç»å¸¸å‡ºç°å“ªäº›é—®é¢˜ï¼Œä»¥åŠå¦‚ä½•è§£å†³ã€‚ å¯ç”¨é—®é¢˜, æ­»é”é—®é¢˜, è„‘è£‚é—®é¢˜

> ä½†é¢è¯•å®˜æé—®çš„é‡ç‚¹ä¸æ˜¯åœç•™åœ¨ç»„ä»¶çš„ä½¿ç”¨ä¸Šï¼Œè€Œæ˜¯ä½ å¯¹åˆ†å¸ƒå¼é”çš„åŸç†é—®é¢˜çš„æŒæ¡ç¨‹åº¦ã€‚â â€¬â€â ï»¿è¿™èƒŒåæ¶‰åŠäº†åˆ†å¸ƒå¼é”çš„åº•å±‚è®¾è®¡é€»è¾‘ï¼Œæ˜¯ä½ éœ€è¦æŒæ¡çš„ã€‚â€Œ

- åŸºäºå…³ç³»å‹æ•°æ®åº“å®ç°åˆ†å¸ƒå¼é” (è«åå…¶å¦™, ä¹Ÿæ²¡ä»€ä¹ˆ   å¹¶ä¸”Rediså®ç°çš„åˆ†å¸ƒå¼é”ä¼šæ¯”æ•°æ®åº“å®ç°çš„æ€§èƒ½æ›´é«˜

- åŸºäºåˆ†å¸ƒå¼ç¼“å­˜å®ç°åˆ†å¸ƒå¼é”, å‰é¢å…¨éƒ½ä¸€æ ·, ä¸ç”¨çœ‹

  > â€¬â€¬â€¬â ï»¿â€¬ï»¿â€¬â€â€Œ**ä½ ä¸èƒ½ä»…åœç•™åœ¨æ“ä½œä¸Šï¼Œå› ä¸ºè¿™å¹¶ä¸èƒ½æ»¡è¶³åº”å¯¹é¢è¯•éœ€è¦æŒæ¡çš„çŸ¥è¯†æ·±åº¦ï¼Œ** æ‰€ä»¥ä½ è¿˜è¦æ¸…æ¥šåŸºäº Redis å®ç°åˆ†å¸ƒå¼é”çš„ä¼˜ç¼ºç‚¹
  >
  > ä¸‰ä¸ªä¼˜ç‚¹: æ€§èƒ½é«˜æ•ˆ, å®ç°æ–¹ä¾¿(SETå‘½ä»¤ä»¥åŠRedisæ”¯æŒçš„luaè„šæœ¬), é¿å…å•ç‚¹æ•…éšœ(???â ï»¿â€ï»¿ï»¿

- å¦‚ä½•åˆç†è®¾ç½®è¶…æ—¶æ—¶é—´

- Redis å¦‚ä½•è§£å†³é›†ç¾¤æƒ…å†µä¸‹åˆ†å¸ƒå¼é”çš„å¯é æ€§. å¦‚æœä½ èƒ½åŸºäº Redlock åŸç†å›ç­”å‡ºæ€ä¹ˆè§£å†³ Redis é›†ç¾¤èŠ‚ç‚¹å®ç°åˆ†å¸ƒå¼é”çš„é—®é¢˜ï¼Œä¼šæˆä¸ºé¢è¯•çš„åŠ åˆ†é¡¹ã€‚(ä¸ç»†)

> ä½†æ˜¯åœ¨é¢è¯•æ—¶ï¼Œä½ è¦åˆ†æ¸…æ¥šé¢è¯•å®˜çš„è€ƒæŸ¥ç‚¹ï¼Œå¹¶ç»“åˆå·¥ä½œä¸­çš„ä¸šåŠ¡åœºæ™¯ç»™å‡ºç­”æ¡ˆï¼Œé¢è¯•å®˜ä¸ä¾§é‡ä½ æ˜¯å¦èƒ½å¾ˆå¿«åœ°ç»™å‡ºç»“æœï¼Œè€Œæ˜¯ä½ æ€è€ƒçš„è¿‡ç¨‹ã€‚

[37ï½œåˆ†å¸ƒå¼é”ï¼šå¦‚ä½•ä¿è¯Redisåˆ†å¸ƒå¼é”çš„é«˜å¯ç”¨å’Œé«˜æ€§èƒ½ï¼Ÿ | JUST DO IT (leeshengis.com)](https://leeshengis.com/archives/700522)

[37ï½œåˆ†å¸ƒå¼é”ï¼šå¦‚ä½•ä¿è¯Redisåˆ†å¸ƒå¼é”çš„é«˜å¯ç”¨å’Œé«˜æ€§èƒ½ï¼Ÿ | è½¦æ–Œçš„æŠ€æœ¯åšå®¢](https://chebin.tech/2023/11/09/37ï½œåˆ†å¸ƒå¼é”ï¼šå¦‚ä½•ä¿è¯Redisåˆ†å¸ƒå¼é”çš„é«˜å¯ç”¨å’Œé«˜æ€§èƒ½ï¼Ÿ/)

> **è¿™ä¸ªæ–‡ç« å¥½ç‰›é€¼å•Š, å’Œç¬¬ä¸€ä¸ªä¸€ç»“åˆ, ç®€ç›´æ— æ•Œäº†!!!!! ** **NB**
>
> æœ€åä¸¤ä¸ªæ€§èƒ½ä¼˜åŒ–æ²¡æ‡‚, å…¶å®ƒéƒ½ok    å¥½æ–‡ç« , é¢è¯•å¿…å¤‡

> åˆ†å¸ƒå¼é”çš„æœ¬è´¨â€”â€”æ’ä»–æ€§ ä½ åœ¨é¢è¯•çš„è¿‡ç¨‹ä¸­è¦å…ˆç®€æ˜æ‰¼è¦åœ°è¯´æ¸…æ¥šé”çš„å®è´¨ï¼Œè¿˜æœ‰åŠ é”å’Œé‡Šæ”¾é”æ˜¯ä»€ä¹ˆã€‚
>
> åœ¨é¢è¯•åˆ†å¸ƒå¼é”çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘å‘ç°å¤§éƒ¨åˆ†äººåªçŸ¥é“å¾ˆåŸºç¡€çš„å‡ ä¸ªç‚¹ï¼Œæ¯”å¦‚è¯´åªèƒ½å›ç­”å‡ºä½¿ç”¨SETNXå‘½ä»¤ï¼Œåˆæˆ–è€…èƒ½ç­”å‡ºè¦è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚å½“è¿›ä¸€æ­¥è¿½é—®çš„æ—¶å€™ï¼Œå°±ä¸çŸ¥é“äº†ã€‚è¿™ä¸€èŠ‚è¯¾çš„ä¸»é¢˜æ˜¯ç”¨Redisæ¥å®ç°ä¸€ä¸ªåˆ†å¸ƒå¼é”ï¼Œä½†æ˜¯å¹¶ä¸æ„å‘³ç€åˆ†å¸ƒå¼é”åªèƒ½ä½¿ç”¨Redisæ¥å®ç°ã€‚ç®€å•æ¥è¯´ï¼Œ**æ”¯æŒæ’ä»–æ€§æ“ä½œ**çš„ä¸­é—´ä»¶éƒ½å¯ä»¥ä½œä¸ºå®ç°åˆ†å¸ƒå¼é”çš„ä¸­é—´ä»¶

- åŠ é”. åˆ†å¸ƒå¼é”çš„æœ¬è´¨â€”â€”æ’ä»–æ€§
- äº®ç‚¹ 1 : ç­‰å¾…æ—¶é—´  åœ¨å‰é¢å›ç­”ä¸­ï¼Œä½ æåˆ°åŠ é”å¤±è´¥äº†ï¼Œå°±è¦ç­‰ä¸€æ®µæ—¶é—´ï¼Œç­‰åˆ«äººé‡Šæ”¾é”ã€‚é‚£ä¹ˆé¢è¯•å®˜å¯èƒ½é—®ä½ ï¼Œç©¶ç«Ÿè¯¥ç­‰å¤šé•¿æ—¶é—´ï¼Ÿ
- äº®ç‚¹ 2 : å¦‚ä½•å®ç°ç­‰å¾…æœºåˆ¶  è½®è¯¢(å’Œç›‘å¬åˆ é™¤äº‹ä»¶)
- äº®ç‚¹ 3 : åŠ é”çš„æ—¶å€™è‹¥è¶…æ—¶äº†, è¯¥å¦‚ä½•åº”å¯¹? è¿™ä¸ªé—®é¢˜æ£˜æ‰‹ä¹‹å¤„åœ¨äºä½ ä¹Ÿä¸çŸ¥é“å‡ºç°è¶…æ—¶çš„æ—¶å€™ï¼Œç©¶ç«Ÿæœ‰æ²¡æœ‰åŠ é”æˆåŠŸã€‚(æ‡‚äº†!NB)

- é”è¿‡æœŸæ—¶é—´

  > æ‰€ä»¥ä½ å°±è¦è€ƒè™‘è¿™ä¹ˆä¸€ä¸ªé—®é¢˜ï¼Œä¸‡ä¸€ä½ åŠ é”çš„é‚£ä¸ªçº¿ç¨‹å´©æºƒäº†å‘¢ï¼Ÿæ¯”å¦‚è¯´ï¼Œå®ƒæ‰€åœ¨çš„æœºå™¨æ•´ä¸ªå´©æºƒäº†ï¼Œåº”è¯¥æ€ä¹ˆåŠï¼Ÿ
  >
  > ä½ æŠ“ä½å…³é”®è¯**æ²¡äººé‡Šæ”¾**æ¥å›ç­”ã€‚

- äº®ç‚¹1ï¼šè¿‡æœŸæ—¶é—´åº”è¯¥å¤šé•¿? è¿™ä¸ªè¿‡æœŸæ—¶é—´åº”è¯¥æ ¹æ®ä¸šåŠ¡æ¥è®¾ç½®.....

  > æ€»çš„æ¥è¯´ï¼Œä¸ç®¡è¿‡æœŸæ—¶é—´è®¾ç½®æˆå¤šé•¿ï¼Œéƒ½å¯èƒ½é‡åˆ°ä¸šåŠ¡æ²¡èƒ½åœ¨æŒæœ‰åˆ†å¸ƒå¼é”æœŸé—´å®Œæˆçš„æƒ…å†µã€‚
  >
  > è¿™ä¹Ÿæ˜¯ä¸ºäº†å¼•å¯¼é¢è¯•å®˜å‘é—®ã€‚è¿™ç§æƒ…å†µç©¶ç«Ÿè¯¥æ€ä¹ˆè§£å†³å‘¢ï¼Ÿç­”æ¡ˆæ˜¯ç»­çº¦ã€‚

- äº®ç‚¹2ï¼šç»­çº¦æœºåˆ¶

  > å¼•å…¥è¿‡æœŸæ—¶é—´æ˜¯ä¸ºäº†é˜²æ­¢æŒæœ‰é”çš„ä¸€æ–¹å®•æœºæ— æ³•é‡Šæ”¾é”, è€Œç»­çº¦æ˜¯ä¸ºäº†é˜²æ­¢è¿‡æœŸæ—¶é—´å†…ä¸šåŠ¡è¿˜æ²¡æœ‰æ‰§è¡Œç»“æŸ.
  >
  > é‚£é”å³å°†è¿‡æœŸçš„æ—¶å€™, å¦‚ä½•åˆ¤æ–­æ˜¯å‡ºé—®é¢˜äº†è¿˜æ˜¯ä¸šåŠ¡æ­£å¸¸æ‰§è¡Œéœ€è¦ç»­çº¦å‘¢? æ˜¯ä¸æ˜¯å¦‚æœå®•æœºäº†, å…¶å®ç»­çº¦åŠŸèƒ½ä¹Ÿå°±å¤±æ•ˆäº†å¯¹å—? ç»­çº¦å™¨å’Œå¯¹ä¸´ç•Œèµ„æºè®¿é—®çš„ç¨‹åºæ˜¯ä¸€ä½“çš„å¯¹å—

  > ç»­çº¦çš„ä¸»ä½“ï¼šå®¢æˆ·ç«¯ä¸»åŠ¨ç»­çº¦ï¼ˆçœ‹é—¨ç‹—æœºåˆ¶ï¼‰
  >
  > **ç»­çº¦æ˜¯ç”±æŒæœ‰é”çš„å®¢æˆ·ç«¯ä¸»åŠ¨å‘èµ·çš„ï¼Œè€Œä¸æ˜¯ç”±Redisä¸»åŠ¨æ£€æµ‹å’Œç»­çº¦ã€‚**
  >
  > å…·ä½“æµç¨‹ï¼š
  >
  > 1. **å®¢æˆ·ç«¯è·å–é”æ—¶**ï¼šä¼šè®¾ç½®ä¸€ä¸ªè¾ƒçŸ­çš„åˆå§‹è¿‡æœŸæ—¶é—´ï¼ˆå¦‚30ç§’ï¼‰ï¼ŒåŒæ—¶å¯åŠ¨ä¸€ä¸ªåå°çº¿ç¨‹ï¼ˆçœ‹é—¨ç‹—çº¿ç¨‹ï¼‰ã€‚
  > 2. **çœ‹é—¨ç‹—çº¿ç¨‹å‘¨æœŸæ€§æ£€æµ‹**ï¼ˆæ¯”å¦‚æ¯10ç§’ï¼‰ï¼š
  >    - æ£€æŸ¥ä¸šåŠ¡æ˜¯å¦ä»åœ¨æ‰§è¡Œ
  >    - å¦‚æœä¸šåŠ¡æœªå®Œæˆï¼Œè‡ªåŠ¨å‘Rediså‘é€`EXPIRE`å‘½ä»¤å»¶é•¿é”çš„è¿‡æœŸæ—¶é—´
  > 3. **ä¸šåŠ¡å®Œæˆåä¸»åŠ¨é‡Šæ”¾é”**ï¼ŒåŒæ—¶åœæ­¢çœ‹é—¨ç‹—çº¿ç¨‹ã€‚
  >
  > ä¼˜åŠ¿ï¼š
  >
  > - **çŸ­è¿‡æœŸæ—¶é—´ + ç»­çº¦æœºåˆ¶**ï¼šå³ä½¿å®¢æˆ·ç«¯å´©æºƒï¼Œé”ä¹Ÿèƒ½å¿«é€Ÿè‡ªåŠ¨é‡Šæ”¾ï¼ˆæœ€å¤šç­‰å¾…åˆå§‹è¿‡æœŸæ—¶é—´ï¼‰ï¼Œé¿å…æ­»é”
  > - **é«˜æ€§èƒ½**ï¼šRedisåªéœ€å¤„ç†ç®€å•çš„`SETNX`å’Œ`EXPIRE`å‘½ä»¤
  >
  > å¦‚ä½•åˆ¤æ–­ç»­çº¦å¿…è¦æ€§ï¼šå¿ƒè·³æœºåˆ¶ + è¶…æ—¶åˆ¤å®š
  >
  > **æ ¸å¿ƒåŸç†ï¼šé€šè¿‡å®¢æˆ·ç«¯æ˜¯å¦å­˜æ´»æ¥åˆ¤æ–­æ˜¯å¦éœ€è¦ç»­çº¦**
  >
  > åˆ¤æ–­é€»è¾‘ï¼š
  >
  > 1. **æ­£å¸¸ä¸šåŠ¡æ‰§è¡Œä¸­**ï¼š
  >
  >    - çœ‹é—¨ç‹—çº¿ç¨‹ä¼šæŒç»­å‘é€ç»­çº¦å¿ƒè·³
  >    - Redisæ¯æ¬¡æ”¶åˆ°ç»­çº¦è¯·æ±‚åé‡ç½®è¿‡æœŸæ—¶é—´
  >    - ç¤ºä¾‹ï¼šåˆå§‹30ç§’è¿‡æœŸï¼Œæ¯10ç§’ç»­çº¦ä¸€æ¬¡ï¼Œé”å®é™…å¯ä»¥æ— é™ç»­æœŸ
  >
  > 2. **å®¢æˆ·ç«¯å¼‚å¸¸å´©æºƒæ—¶**ï¼š
  >
  >    - çœ‹é—¨ç‹—çº¿ç¨‹éšè¿›ç¨‹ç»ˆæ­¢
  >
  >    - ä¸å†å‘é€ç»­çº¦è¯·æ±‚
  >
  >    - Redisä¸­çš„keyåœ¨è¿‡æœŸæ—¶é—´åˆ°è¾¾åè‡ªåŠ¨åˆ é™¤
  >
  > å…¸å‹å®ç°æ–¹æ¡ˆå¯¹æ¯”
  >
  > | æ–¹æ¡ˆ                                   | é€‚ç”¨åœºæ™¯           |
  > | :------------------------------------- | :----------------- |
  > | è‡ªåŠ¨ç»­çº¦ï¼ˆçœ‹é—¨ç‹—ï¼‰é¿å…ä¸šåŠ¡æœªå®Œæˆé”è¿‡æœŸ | é•¿è€—æ—¶ä¸šåŠ¡         |
  > | å›ºå®šè¿‡æœŸæ—¶é—´(éœ€è¦å‡†ç¡®é¢„ä¼°ä¸šåŠ¡æ—¶é—´)     | çŸ­è€—æ—¶ç¡®å®šæ€§ä¸šåŠ¡   |
  > | ä¸€æ¬¡æ€§é”(å¯èƒ½æå‰é‡Šæ”¾å¯¼è‡´å¹¶å‘é—®é¢˜)     | æé«˜å¹¶å‘çŸ­è€—æ—¶åœºæ™¯ |

- äº®ç‚¹3ï¼šä¸­æ–­ä¸šåŠ¡

  > æ¯”å¦‚è¯´åˆ†å¸ƒå¼é”åœ¨ç»­çº¦å¤±è´¥çš„æ—¶å€™ï¼Œç»™ä½ å‘äº†ä¸€ä¸ªä¿¡å·ã€‚è¿™ä¸ªæ—¶å€™æ˜¯å¦ä¸­æ–­ä¸šåŠ¡å®Œå…¨æ˜¯çœ‹ä½ çš„ä¸šåŠ¡ä»£ç æ˜¯å¦‚ä½•å®ç°çš„ã€‚

- é‡Šæ”¾é”

  > åœ¨é‡Šæ”¾é”çš„æ—¶å€™ï¼Œè¦å…ˆç¡®è®¤é”æ˜¯ä¸æ˜¯è‡ªå·±åŠ çš„ï¼Œé˜²æ­¢å› ä¸ºç³»ç»Ÿæ•…éšœæˆ–è€…æœ‰äººæ‰‹åŠ¨æ“ä½œäº†Rediså¯¼è‡´é”è¢«åˆ«äººæŒæœ‰äº†ã€‚

- Redlock(çœ‹ä¸‹é¢è¿™æ®µå³å¯)

  > é¦–å…ˆï¼ŒRedisçš„ä¸»ä»åˆ‡æ¢æœºåˆ¶æ˜¯è§£å†³ä¸äº†è¿™ä¸ªé—®é¢˜çš„ï¼Œå› ä¸ºRedisçš„ä¸»ä»åŒæ­¥æ˜¯å¼‚æ­¥çš„ã€‚ä¹Ÿå°±æ˜¯è¯´å½“ä½ æ‹¿åˆ°ä¸€ä¸ªåˆ†å¸ƒå¼é”çš„æ—¶å€™ï¼Œè¿™ä¸ªé”è¿˜æ²¡æœ‰åŒæ­¥åˆ°ä»èŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹å°±å¯èƒ½å´©æºƒäº†ã€‚è¿™ä¸ªæ—¶å€™ä»èŠ‚ç‚¹è¢«æå‡æˆä¸»èŠ‚ç‚¹ï¼Œé‡Œé¢å¹¶æ²¡æœ‰ä½ çš„åˆ†å¸ƒå¼é”ï¼Œæ‰€ä»¥åˆ«äººå°±å¯ä»¥æ‹¿åˆ°åˆ†å¸ƒå¼é”ã€‚
  >
  > ä½ åªéœ€è¦æŒæ¡Redlockçš„åŸºæœ¬æ¦‚å¿µå°±å¯ä»¥ï¼Œä¸éœ€è¦æ·±å…¥å»ç ”ç©¶ã€‚åŸå› ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯ç›®å‰ç»å¤§éƒ¨åˆ†å…¬å¸ä½¿ç”¨çš„åˆ†å¸ƒå¼é”ï¼Œéƒ½æ²¡æœ‰æŒ‰ç…§Redlockç®—æ³•æ¥å®ç°ï¼Œå› ä¸ºRedlockæˆæœ¬é«˜ï¼Œæ€§èƒ½ä¹Ÿæ¯”è¾ƒå·®ã€‚

  

> todo åˆ†å¸ƒå¼é”çš„æ€§èƒ½ä¼˜åŒ–(æ‡‚äº†!NB)  singleflightç®—æ³•å¯ä»¥å¥½å¥½çœ‹çœ‹
> å»åˆ†å¸ƒå¼é”(æ²¡çœ‹æ‡‚, ä¸é‡è¦)



[21 ZooKeeper åˆ†å¸ƒå¼é”ï¼šå®ç°å’ŒåŸç†è§£æ](https://learn.lianglianglee.com/ä¸“æ /ZooKeeperæºç åˆ†æä¸å®æˆ˜-å®Œ/21 ZooKeeper åˆ†å¸ƒå¼é”ï¼šå®ç°å’ŒåŸç†è§£æ.md)

[21 åˆ†å¸ƒå¼é”ï¼šä¸ºä»€ä¹ˆåŸºäºetcdå®ç°åˆ†å¸ƒå¼é”æ¯”Redisé”æ›´å®‰å…¨ï¼Ÿ](https://learn.lianglianglee.com/ä¸“æ /etcdå®æˆ˜è¯¾/21 åˆ†å¸ƒå¼é”ï¼šä¸ºä»€ä¹ˆåŸºäºetcdå®ç°åˆ†å¸ƒå¼é”æ¯”Redisé”æ›´å®‰å…¨ï¼Ÿ.md)

### çƒ­keyå’Œå¤§key

çƒ­keyå¤§keyé—®é¢˜æ˜¯ä»€ä¹ˆ? è§£å†³æ–¹æ¡ˆæ˜¯ä»€ä¹ˆ?

---

[06 Hot Keyå’ŒBig Keyå¼•å‘çš„é—®é¢˜æ€ä¹ˆåº”å¯¹ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /300åˆ†é’Ÿåƒé€åˆ†å¸ƒå¼ç¼“å­˜-å®Œ/06 Hot Keyå’ŒBig Keyå¼•å‘çš„é—®é¢˜æ€ä¹ˆåº”å¯¹ï¼Ÿ.md)

- Hot Key

  > ä¸»è¦æ˜¯å› ä¸ºçªå‘çƒ­é—¨äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè¶…å¤§é‡çš„è¯·æ±‚è®¿é—®çƒ­ç‚¹äº‹ä»¶å¯¹åº”çš„ keyï¼Œæ¯”å¦‚å¾®åšä¸­æ•°åä¸‡ã€æ•°ç™¾ä¸‡çš„ç”¨æˆ·åŒæ—¶å»åƒä¸€ä¸ªæ–°ç“œã€‚æ•°åä¸‡çš„è®¿é—®è¯·æ±‚åŒä¸€ä¸ª keyï¼Œæµé‡é›†ä¸­æ‰“åœ¨ä¸€ä¸ªç¼“å­˜èŠ‚ç‚¹æœºå™¨ï¼Œè¿™ä¸ªç¼“å­˜æœºå™¨å¾ˆå®¹æ˜“è¢«æ‰“åˆ°ç‰©ç†ç½‘å¡ã€å¸¦å®½ã€CPU çš„æé™ï¼Œä»è€Œå¯¼è‡´ç¼“å­˜è®¿é—®å˜æ…¢ã€å¡é¡¿ã€‚

- è§£å†³æ–¹æ³•

  > 1. æ‰¾å‡ºHot key(???)
  > 2. æ¯”å¦‚ä¸€ä¸ªçƒ­ key åå­—å« hotkeyï¼Œå¯ä»¥è¢«åˆ†æ•£ä¸º hotkey#1ã€hotkey#2ã€hotkey#3ï¼Œâ€¦â€¦hotkey#nï¼Œè¿™ n ä¸ª key åˆ†æ•£å­˜åœ¨å¤šä¸ªç¼“å­˜èŠ‚ç‚¹ï¼Œç„¶å client ç«¯è¯·æ±‚æ—¶ï¼Œéšæœºè®¿é—®å…¶ä¸­æŸä¸ªåç¼€çš„ hotkeyï¼Œè¿™æ ·å°±å¯ä»¥æŠŠçƒ­ key çš„è¯·æ±‚æ‰“æ•£ï¼Œé¿å…ä¸€ä¸ªç¼“å­˜èŠ‚ç‚¹è¿‡è½½
  >    è¿™é‡Œè¿˜æœ‰æ–¹æ³• çœ‹ä¸æ‡‚

- Big Key  ç¼“å­˜è®¿é—®æ—¶ï¼Œéƒ¨åˆ† Key çš„ Value è¿‡å¤§ï¼Œè¯»å†™ã€åŠ è½½æ˜“è¶…æ—¶çš„ç°è±¡ã€‚
  æŠ½è±¡, æ²¡çœ‹æ‡‚

[å¦‚ä½•æ‰¾å‡ºä¼˜åŒ–å¤§Keyä¸çƒ­Key,äº§ç”Ÿçš„åŸå› å’Œé—®é¢˜_äº‘æ•°æ®åº“ Redis ç‰ˆ(Redis)-é˜¿é‡Œäº‘å¸®åŠ©ä¸­å¿ƒ (aliyun.com)](https://help.aliyun.com/zh/redis/user-guide/identify-and-handle-large-keys-and-hotkeys)



[äº‘æ•°æ®åº“ Redis çƒ­ Key ä¸ å¤§ Key-æœ€ä½³å®è·µ-æ–‡æ¡£ä¸­å¿ƒ-è…¾è®¯äº‘ (tencent.com)](https://cloud.tencent.com/document/product/239/89468)

- å¤§key çƒ­keyå®šä¹‰

[37 æ•°æ®åˆ†å¸ƒä¼˜åŒ–ï¼šå¦‚ä½•åº”å¯¹æ•°æ®å€¾æ–œï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /Redis æ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜/37  æ•°æ®åˆ†å¸ƒä¼˜åŒ–ï¼šå¦‚ä½•åº”å¯¹æ•°æ®å€¾æ–œï¼Ÿ.md)



### ç§’æ€åœºæ™¯

æ€ä¹ˆç”¨Rediså®ç°ç§’æ€

---

[â€Œâ€¬ï»¿â€Œï»¿â€â€â€Œï»¿â€¬â â â€Œâ€â€â€¬â€â€â â€¬â€ï»¿â â€â€Œâ€¬ï»¿â€Œï»¿ç§’æ€ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnMjrBLhw661kReWXuLYDJJh)

ä»€ä¹ˆæ˜¯ç§’æ€?  ç§’æ€çš„å‡ ä¸ªæ³¨æ„ç‚¹

[ç§’æ€ä¸“æ  - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/L1WKwK29ti7Z7dkIS2EcgSdnnoh)

[36 Redisæ”¯æ’‘ç§’æ€åœºæ™¯çš„å…³é”®æŠ€æœ¯å’Œå®è·µéƒ½æœ‰å“ªäº›ï¼Ÿ (lianglianglee.com)](https://learn.lianglianglee.com/ä¸“æ /Redis æ ¸å¿ƒæŠ€æœ¯ä¸å®æˆ˜/36  Redisæ”¯æ’‘ç§’æ€åœºæ™¯çš„å…³é”®æŠ€æœ¯å’Œå®è·µéƒ½æœ‰å“ªäº›ï¼Ÿ.md)

> ç®€å•ä¸”æ¸…æ¥š

- ç§’æ€åœºæ™¯çš„è´Ÿè½½ç‰¹å¾, ä»¥åŠå¯¹æ”¯æ’‘ç³»ç»Ÿçš„è¦æ±‚

  > ç¬¬ä¸€ä¸ªç‰¹å¾æ˜¯ç¬æ—¶å¹¶å‘è®¿é—®é‡éå¸¸é«˜ã€‚  éœ€è¦ä½¿ç”¨ Redis å…ˆæ‹¦æˆªå¤§éƒ¨åˆ†è¯·æ±‚ï¼Œé¿å…å¤§é‡è¯·æ±‚ç›´æ¥å‘é€ç»™æ•°æ®åº“ï¼ŒæŠŠæ•°æ®åº“å‹å®ã€‚
  >
  > ç¬¬äºŒä¸ªç‰¹å¾æ˜¯è¯» >> å†™ï¼Œè€Œä¸”è¯»æ“ä½œæ˜¯ç®€å•çš„æŸ¥è¯¢æ“ä½œã€‚

- ç§’æ€æ´»åŠ¨å‰ ä¸éœ€è¦Redis   ç§’æ€æ´»åŠ¨ç»“æŸå å‹åŠ›å°, ä¸è®¨è®º

- ç§’æ€æ´»åŠ¨å¼€å§‹  è¿™ä¸ªé˜¶æ®µçš„æ“ä½œå°±æ˜¯ä¸‰ä¸ªï¼šåº“å­˜æŸ¥éªŒã€åº“å­˜æ‰£å‡å’Œè®¢å•å¤„ç†

  > æ‰€ä»¥ï¼Œè¿™ä¸ªé˜¶æ®µä¸­æœ€å¤§çš„å¹¶å‘å‹åŠ›éƒ½åœ¨åº“å­˜æŸ¥éªŒæ“ä½œä¸Šã€‚ä¸ºäº†æ”¯æ’‘å¤§é‡é«˜å¹¶å‘çš„åº“å­˜æŸ¥éªŒè¯·æ±‚ï¼Œæˆ‘ä»¬éœ€è¦åœ¨è¿™ä¸ªç¯èŠ‚ä½¿ç”¨ Redis ä¿å­˜åº“å­˜é‡
  >
  > è®¢å•å¤„ç†å¯ä»¥åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œ  åº“å­˜æ‰£å‡æ“ä½œä¸èƒ½åœ¨æ•°æ®åº“æ‰§è¡Œ(ä¸ºä»€ä¹ˆ? è‹¥æ‰£å‡ä¸äº¤ç»™ç¼“å­˜, è€Œæ˜¯æ•°æ®åº“, é‚£ä¹ˆæ‰£å‡åéœ€è¦åŒæ­¥ç»™Redis, RedisåˆåŒæ—¶è´Ÿè´£ç€é«˜å¹¶å‘çš„æ•°æ®æŸ¥éªŒ, ä¼šå¾ˆå½±å“(é—®deepseek)
  >
  > æ‰€ä»¥åº“å­˜æŸ¥éªŒ+åº“å­˜æ‰£å‡äº¤ç»™Redisç¼“å­˜
  >
  > éœ€è¦æŸ¥éªŒå’Œæ‰£å‡å•†å“åº“å­˜ï¼Œåº“å­˜æŸ¥éªŒé¢ä¸´å¤§é‡çš„é«˜å¹¶å‘è¯·æ±‚ï¼Œè€Œåº“å­˜æ‰£å‡åˆéœ€è¦å’Œåº“å­˜æŸ¥éªŒä¸€èµ·æ‰§è¡Œï¼Œä»¥ä¿è¯**åŸå­æ€§**(é˜²æ­¢è¯»å†™å¹¶å‘å‡ºç°é—®é¢˜, å¾ˆç»å…¸)ã€‚è¿™å°±æ˜¯ç§’æ€å¯¹ Redis çš„éœ€æ±‚ã€‚
  >
  > <img src="C:\Users\yangzilong\Desktop\markdown\CS\Redis\Redisæ–°\image-20250302221040002.png" alt="image-20250302221040002" style="zoom:50%;" />

- Redis çš„å“ªäº›æ–¹æ³•å¯ä»¥æ”¯æ’‘ç§’æ€åœºæ™¯

  > ç§’æ€åœºæ™¯å¯¹ Redis æ“ä½œçš„æ ¹æœ¬è¦æ±‚æœ‰ä¸¤ä¸ª 1.æ”¯æŒé«˜å¹¶å‘(è¿™é‡Œæ¶‰åŠRedisé›†ç¾¤çš„çŸ¥è¯†, æ²¡å¤ä¹ å‘¢) 2.  åŸå­æ€§

- åŸºäºåŸå­æ“ä½œæ”¯æ’‘ç§’æ€åœºæ™¯: ä½¿ç”¨åŸå­æ€§çš„ Lua è„šæœ¬æ¥å®ç°åº“å­˜æŸ¥éªŒå’Œåº“å­˜æ‰£å‡

- åŸºäºåˆ†å¸ƒå¼é”æ¥æ”¯æ’‘ç§’æ€åœºæ™¯: ä½¿ç”¨åˆ†å¸ƒå¼é”æ¥ä¿è¯å¤šä¸ªå®¢æˆ·ç«¯èƒ½äº’æ–¥æ‰§è¡Œè¿™ä¸¤ä¸ªæ“ä½œ

  > å…ˆè®©å®¢æˆ·ç«¯å‘ Redis ç”³è¯·åˆ†å¸ƒå¼é”ï¼Œåªæœ‰æ‹¿åˆ°é”çš„å®¢æˆ·ç«¯æ‰èƒ½æ‰§è¡Œåº“å­˜æŸ¥éªŒå’Œåº“å­˜æ‰£å‡ã€‚è¿™æ ·ä¸€æ¥ï¼Œå¤§é‡çš„ç§’æ€è¯·æ±‚å°±ä¼šåœ¨äº‰å¤ºåˆ†å¸ƒå¼é”æ—¶è¢«è¿‡æ»¤æ‰ã€‚è€Œä¸”ï¼Œåº“å­˜æŸ¥éªŒå’Œæ‰£å‡ä¹Ÿä¸ç”¨ä½¿ç”¨åŸå­æ“ä½œäº†ï¼Œå› ä¸ºå¤šä¸ªå¹¶å‘å®¢æˆ·ç«¯åªæœ‰ä¸€ä¸ªå®¢æˆ·ç«¯èƒ½å¤Ÿæ‹¿åˆ°é”ï¼Œå·²ç»ä¿è¯äº†å®¢æˆ·ç«¯å¹¶å‘è®¿é—®çš„äº’æ–¥æ€§ã€‚
  >
  > **æˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ‡ç‰‡é›†ç¾¤ä¸­çš„ä¸åŒå®ä¾‹æ¥åˆ†åˆ«ä¿å­˜åˆ†å¸ƒå¼é”å’Œå•†å“åº“å­˜ä¿¡æ¯**ã€‚ä½¿ç”¨è¿™ç§ä¿å­˜æ–¹å¼åï¼Œç§’æ€è¯·æ±‚ä¼šé¦–å…ˆè®¿é—®ä¿å­˜åˆ†å¸ƒå¼é”çš„å®ä¾‹ã€‚å¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰æ‹¿åˆ°é”ï¼Œè¿™äº›å®¢æˆ·ç«¯å°±ä¸ä¼šæŸ¥è¯¢å•†å“åº“å­˜ï¼Œè¿™å°±å¯ä»¥å‡è½»ä¿å­˜åº“å­˜ä¿¡æ¯çš„å®ä¾‹çš„å‹åŠ›äº†ã€‚



- å½“ç„¶ï¼Œå¯¹äºç§’æ€åœºæ™¯æ¥è¯´ï¼Œåªç”¨ Redis æ˜¯ä¸å¤Ÿçš„ã€‚ç§’æ€ç³»ç»Ÿæ˜¯ä¸€ä¸ªç³»ç»Ÿæ€§å·¥ç¨‹....







è¯¦ç»†æ¥è¯´, å¯¹è±¡å¿…å­¦, æ‰§è¡Œæµç¨‹ä¸ç®—é‚£ä¹ˆé‡è¦, ä½†æ˜¯ä¹Ÿå­¦ä¸€å­¦, æŒä¹…åŒ–å¿…å­¦å§, ä¸”å­¦è¿‡äº†, åœºæ™¯å¿…å­¦! å¾ˆé‡è¦? é›†ç¾¤æ²¡é‚£ä¹ˆé‡è¦, ä½†æ˜¯è€å­å­¦è¿‡äº†

Redisè‡ªæµ‹é¢˜, é¢˜åº“ åå¤å¹², è¿™æ ·æ‰èƒ½åœ¨é¢è¯•çš„æ—¶å€™åŸå”±









----



[â€ï»¿â€¬â€¬â€¬ï»¿â€â€Œâ â€Œï»¿â ï»¿â€Œï»¿â€ï»¿â€Œâ â â€Œâ€¬â Redisæ˜¯å•çº¿ç¨‹è¿˜æ˜¯å¤šçº¿ç¨‹ï¼Ÿ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/K2nDw8Qt6iMvWHkaG0zcok3LnCc)



[36ï½œRedis å•çº¿ç¨‹ï¼šä¸ºä»€ä¹ˆ Redis ç”¨å•çº¿ç¨‹è€Œ Memcached ç”¨å¤šçº¿ç¨‹ï¼Ÿ | JUST DO IT (leeshengis.com)](https://leeshengis.com/archives/699268)

> ! leeshengis
>
> **è¿™ä¸ªæ–‡ç« è¿˜æ˜¯ä¸€å¦‚æ—¢å¾€çš„ç¥**

> ?
>
> äº®ç‚¹1ä¸è¡Œ, è·³è¿‡
>
> <u>**6.0ä¹‹åçš„å¤šçº¿ç¨‹IOåˆ°åº•æ˜¯æ€ä¹ˆå®ç°çš„?**</u>

> *
>
> è€Œå®é™…ä¸Šï¼ŒRedis å¹¶ä¸æ˜¯å•çº¿ç¨‹çš„ã€‚ä¸šç•Œè¯´ Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œæ˜¯æŒ‡å®ƒåœ¨å¤„ç†å‘½ä»¤çš„æ—¶å€™ï¼Œæ˜¯å•çº¿ç¨‹çš„ã€‚åœ¨ Redis 6.0 ä¹‹å‰ï¼ŒRedis çš„ IO ä¹Ÿæ˜¯å•çº¿ç¨‹çš„ï¼Œä½†æ˜¯åœ¨ 6.0 ä¹‹åä¹Ÿæ”¹æˆäº†å¤šçº¿ç¨‹ã€‚ä½†æ˜¯å…¶ä»–éƒ¨åˆ†ï¼Œæ¯”å¦‚è¯´æŒä¹…åŒ–ã€æ•°æ®åŒæ­¥ä¹‹ç±»çš„åŠŸèƒ½ï¼Œéƒ½æ˜¯ç”±åˆ«çš„çº¿ç¨‹æ¥å®Œæˆçš„ã€‚å› æ­¤ä¸¥æ ¼æ¥è¯´ï¼ŒRedis å…¶å®æ˜¯å¤šçº¿ç¨‹çš„ã€‚
>
> æœ‰å…³ Redis çš„çº¿ç¨‹æ¨¡å‹é¢è¯•æ˜¯çº¯ç†è®ºé¢è¯•ï¼Œæ‰€ä»¥ä½ éœ€è¦è®°å¿†çš„ä¸œè¥¿å¾ˆå¤šã€‚
>
> ä¸€èˆ¬æ¥è¯´ï¼Œé¢è¯•å®˜éƒ½ä¼šé—®ä½ â€œä¸ºä»€ä¹ˆ Redis æ˜¯å•çº¿ç¨‹çš„ï¼Œä½†æ˜¯åˆèƒ½åšåˆ°é«˜æ€§èƒ½ï¼Ÿâ€å¾ˆå¤šäººä¼šä¸‹æ„è¯†åœ°å›ç­”ï¼šâ€œå› ä¸º Redis æ˜¯å®Œå…¨å†…å­˜æ“ä½œçš„ã€‚â€è¿™ä¸ªç†ç”±å¾ˆå…³é”®ï¼Œä½†æ˜¯è¿™å¹¶ä¸æ˜¯é¢è¯•å®˜æƒ³è¦çš„ç­”æ¡ˆï¼Œä»–å¸Œæœ›ä½ å›ç­”çš„æ˜¯ Redis çš„ IO æ¨¡å‹ã€‚
>
> åé¢åœ¨ 6.0 çš„æ—¶å€™ï¼ŒRedis æ”¹æˆäº†å¤šçº¿ç¨‹æ¨¡å‹ï¼Œä½†æ˜¯åŸºæœ¬åŸç†è¿˜æ˜¯ Reactor + epollã€‚
>
> äº®ç‚¹äºŒï¼šRedis ä¸ºä»€ä¹ˆå¼•å…¥å¤šçº¿ç¨‹ï¼Ÿ    åé¢çœ‹æ–‡ç« 

æœ‰å…³6.0çš„å¤šçº¿ç¨‹IOæ¨¡å‹, ä¸‹é¢æ–‡ç« å¯ç”¨ä½œè¡¥å……



[â¡â¢â€¬â¤â€Œï»¿ï»¿ï»¿â£â¢â¤ï»¿â€¬â¢â€â€¬â£â£â¡â€¬â¤â¤â€Œâ¢â€Œï»¿â€¬â¤â€Œâ£â¡â€¬â€Œâ¢â€¬â£ï»¿â€Œï»¿Redisåœ¨å†…å­˜ä¸­æ˜¯æ€ä¹ˆå­˜å‚¨çš„ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcn9BKnbwsckaPqAoaI1zwMJh)

> æ€»ç»“ä¸è¯„ä»· : 
>
> è¿™é‡Œå…¶å®å°±æ˜¯è®²çš„, Redisæœ¬èº«å°±æ˜¯ä¸€ä¸ªKVå­˜å‚¨ç»“æ„, æ‰€ä»¥æœ€æ ¹æœ¬ä¸Šå°±æ˜¯ä¸€ä¸ªå­—å…¸dict, ä¹Ÿå°±æ˜¯ä¸€ä¸ªå“ˆå¸Œè¡¨
>
> é‡Œé¢è®²çš„æ¯”è¾ƒç®€å•, å…¶å®redisè®¾è®¡ä¸å®ç°è¿™æœ¬ä¹¦éƒ½è®²è¿‡äº†

[Rediså†…å­˜é¢è¯•ä¸åˆ†æ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnzOrOuLJYEyehoG9vUOuMt1)

ä¸‰ä¸ªé—®é¢˜.. çœŸä¸çŸ¥é“è¿™Bæ–‡æ¡£å¹²å˜›æ¥çš„, å…¶å®çŸ¥é“äº†ä¸Šä¸€ä¸ªæ–‡æ¡£, è¿™ä¸ªå°±çŸ¥é“äº†, ä¸»è¦è¿˜æ˜¯è€ƒå¯ŸRedisåˆ°åº•æ˜¯å¦‚ä½•å­˜å‚¨KVçš„, è¿˜æœ‰è¿‡æœŸæ˜¯æ€ä¹ˆå®ç°çš„

[â€Œï»¿â¢â€Œâ€â€Œï»¿â€¬â€¬â£â¡â£â€Œâ€Œï»¿â€Œâ¤â¢â¡â¡â¢â£ï»¿â¡â€Œï»¿â¡â£â¤â€â€¬â£â¡â£â€â€¬â¤ï»¿ï»¿â€¬â€â¢â¤â£â€¬Redisæ˜¯å•çº¿ç¨‹ï¼Œè¿˜æ˜¯å¤šçº¿ç¨‹ï¼Ÿï¼ˆé‡ç‚¹ç†è§£ï¼‰ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnF8yKiMzoD38GR6fpaElhlb)

æ ¸å¿ƒå°±æ˜¯å›´ç»•Rediså•çº¿ç¨‹è¿™ä¸ªé—®é¢˜

[ï»¿â€¬ï»¿â£â£â€¬â€Œâ¤â£â¡â€â¤â¢â€â£â€Œâ¤â¢â¢â€Œâ£â¢â£â¢â¡â¤â€¬â¢â£â€¬â€Œâ€Œâ¤ï»¿ï»¿â€Œï»¿â€¬â¡å•çº¿ç¨‹ä¸ºä»€ä¹ˆèƒ½è¿™ä¹ˆå¿«ï¼ˆé‡ç‚¹ç†è§£ï¼‰ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnwpT0SIYOthdl78S7OZouqf)

è¿™é‡Œè®²çš„å…¶å®è¿˜ä¸é”™, ä¸»è¦ä»å•çº¿ç¨‹ + IOå¤šè·¯å¤ç”¨çš„è§’åº¦æ¥çœ‹çš„

[â¡â¡â£â¤ï»¿â€Œï»¿â¢â€Œâ€Œâ¢â€â€¬â€Œâ¢â¢â¢â¡ï»¿â¤â€â¢â€Œâ€â€¬â£â¤â€â¢â€â¡â£â€Œâ¢â€â€â€â¤â¤â¡â¢Rediså¤„ç†è¿‡ç¨‹-æºç è§£æï¼ˆç¨å¾®äº†è§£å³å¯ï¼‰ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnts0xtSCT0XCU0E66ce8wCd)

todo

[â€Œâ€â¤â€â€Œâ€â¡â£â¤â£â£â€¬â€¬â€â¡ï»¿â¢â¢â¡â€¬â€¬â€Œâ£â¡â£ï»¿â€â¡â¢â€¬â¢â£â£â¡â€â¢â€¬â€â¡â€Œâ¢â€ŒRediså•çº¿ç¨‹é¢è¯•ä¸åˆ†æ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnr52jhHa0drtDxvAMJqI9sh)

æœ‰å‡ ä¸ªé—®é¢˜, ç­”çš„ä¸€èˆ¬å§, ä½†æ˜¯æˆ‘ä»¬å¯ä»¥ç›´åˆ°é—®é¢˜, ä¹‹åå†è¡¥å……å›ç­”ä¸€ä¸‹

[â€Œâ¤â¤â¤â£â¢â¤â€Œâ£â€¬â¤â€Œâ€¬â¢â€â¤â¡ï»¿ï»¿â¡â€Œï»¿â€â¤â€Œâ¤â¤â¡â€â¢â¢ï»¿â€â£â¢â£ï»¿â€â¤â€ï»¿â£å¤šçº¿ç¨‹æ˜¯æ€ä¹ˆå›äº‹ï¼ˆéœ€è¦äº†è§£ï¼‰ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcniustSxgJNYcpCQZnjsiEUf)

å› ä¸ºä¸Šè¿°æƒ…å†µï¼ŒRedisé€‰æ‹©äº†å¼•å…¥å¤šçº¿ç¨‹æ¥å¤„ç†ç½‘ç»œI/Oï¼Œä»ç„¶ä½¿ç”¨å•çº¿ç¨‹æ¡†æ¶æ¥æ‰§è¡ŒRediså‘½ä»¤ï¼Œè¿™æ ·æ—¢ä¿æŒäº†Redisæ ¸å¿ƒçš„å•çº¿ç¨‹å¤„ç†æ¶æ„ï¼Œå®Œå…¨å…¼å®¹ä»¥å‰çš„å®ç°ï¼Œåˆå¼•å…¥äº†å¤šçº¿ç¨‹è§£å†³æå‡ç½‘ç»œI/Oçš„æ€§èƒ½ã€‚

todo

[â€Œâ€Œâ£â€¬â¢â£â¤â£â€¬â€¬â¢â€â¡â€¬â€¬â€Œâ£â¤ï»¿â£â¡â¢â¢â€â£â£â¤â¡â¡â€â¤â€â€¬â€¬â€ï»¿â¤Rediså¤šçº¿ç¨‹é¢è¯•ä¸åˆ†æ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/V4ZTwvw61ifzUzkx18Ccg19OnVN)

å°±ä¸‰ä¸ªé—®é¢˜.... ä¸Šé¢è¿™ä¸ªæ–‡æ¡£çš„å¯¹åº”é—®é¢˜... å›ç­”çš„å…¶å®ä¸€èˆ¬

[â¤â¤â¡â¤â£â¡ï»¿â€â€Œâ¡â€¬ï»¿â¤â€â€¬â£â€¬â€¬â¡â€â¢â¡â¡â£â¤â¤â€¬â£â€â€â¡â¢â€â€Œâ¤â€Œâ¡â€Œâ€¬â€¬å†…å­˜æ»¡äº†æ€ä¹ˆåŠ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcn75mzfzhsiV86pzaasPlWIf)

è®²çš„ä¸æ˜¯å¾ˆå¤š... è¯´å‡ºäº†8ç§å†…å­˜æ·˜æ±°æœºåˆ¶

[â¡â¤â€Œâ€â£ï»¿â£â¢â€¬â€¬â€Œâ€¬â£â€Œï»¿â£â¢â¤â€¬â€Œâ€â€¬â€Œâ¤â¡â€¬â¤â€Œâ€Œâ¢â¡â€ï»¿â€â¢â¡â£â¡å†…å­˜æ·˜æ±°ç®—æ³•-LRU - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnE4S4MmoAFPljPzh50QQeuh)

todo  æœ‰ç‚¹æ‹‰

[ï»¿â€¬â¤ï»¿â¡â€â£â¤â¢â€â¤â£â¡â€¬â¤â¢â£â€¬â¡â£â€ï»¿â£â¡ï»¿â€â¤â¡â¡â¡â£ï»¿â€â€Œâ¡â¢â¡å†…å­˜æ·˜æ±°ç®—æ³•-LFU - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnISEtOj5hEKa84ZcNOg4q2b)

todo..  è¿˜è¡Œå§... 

[â¤â¤â¡â¤â£â£â€ï»¿ï»¿â£â€¬ï»¿â€¬â¤â€â€Œâ€¬â¢â€Œâ€Œâ¢ï»¿â€Œâ€ï»¿â€Œâ¡â€¬â¤â€¬ï»¿ï»¿â¡â¢â¢â¤â¢â€â€â€â¢ï»¿ï»¿å†…å­˜æ·˜æ±°é¢è¯•ä¸åˆ†æ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnBBUC0CYHy5G7fMmgPPROzg)

å‡ ä¸ªé—®é¢˜, ä¸Šé¢ä¸‰ä¸ªæ–‡æ¡£å¯¹åº”çš„é¢è¯•é—®é¢˜....  ä¸æ˜¯å¾ˆå¤šå•Š.. ç›´è§‰æ¥çœ‹

[â€Œâ¢â¡â¢â€¬â€â¡â¤â¢â€¬â€â£â€¬â€â£â¡â¤â¢â¡â¡â€â£â¤â£â€â¢â€¬â¡â€¬â¡ï»¿â¢ï»¿â¤â¤â£â€Œâ€â€Œâ£â¡â€Œâ£ç¼“å­˜ä¸€è‡´æ€§æ€ä¹ˆä¿è¯ - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnEJdzUmS3CgUHXUCjJY5Iad)

?

[å®ç° Redis åˆ†å¸ƒå¼é” - é£ä¹¦äº‘æ–‡æ¡£ (feishu.cn)](https://ls8sck0zrg.feishu.cn/wiki/wikcnaF1qH0IuDirpmALM8rf79g)

todo

[Redis å¤§ Key å¯¹æŒä¹…åŒ–æœ‰ä»€ä¹ˆå½±å“ï¼Ÿ | å°æ—coding (xiaolincoding.com)](https://xiaolincoding.com/redis/storage/bigkey_aof_rdb.html#å¤§-key-å¯¹-aof-æ—¥å¿—çš„å½±å“)

> åˆ†åˆ«è¯´è¯´è¿™ä¸‰ç§ç­–ç•¥ï¼Œåœ¨æŒä¹…åŒ–å¤§ Key çš„æ—¶å€™ï¼Œä¼šå½±å“ä»€ä¹ˆï¼Ÿ
